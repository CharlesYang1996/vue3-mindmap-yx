import{m as e,o as t,P as n,t as a,h as o,l,a as i,s,d as r,r as d,u as c,w as u,v as h,c as p,b as m,F as g,e as v,f,g as y,z as x,i as b,j as w,k as $,n as M,p as _,q as B,x as k,y as L,A as z,B as C,C as E,D as j,E as N,G as S}from"./vendor.5920f0b5.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(n){const a=new URL(e,location),o=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((n,l)=>{const i=new URL(e,a);if(self[t].moduleMap[i])return n(self[t].moduleMap[i]);const s=new Blob([`import * as m from '${i}';`,`${t}.moduleMap['${i}']=m;`],{type:"text/javascript"}),r=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(s),onerror(){l(new Error(`Failed to import: ${e}`)),o(r)},onload(){n(self[t].moduleMap[i]),o(r)}});document.head.appendChild(r)})),self[t].moduleMap={}}}("/vue3-mindmap/assets/");var D=[{name:"如何学习D3",children:[{name:"预备知识",children:[{name:"HTML & CSS"},{name:"JavaScript"},{name:"DOM"},{name:"SVG"},{name:"test\ntest"}]},{name:"安装",_children:[{name:"折叠节点"}]},{name:"入门",children:[{name:"选择集"},{name:"test"},{name:"绑定数据"},{name:"添加删除元素"},{name:"简单图形",children:[{name:"柱形图"},{name:"折线图"},{name:"散点图"}]},{name:"比例尺"},{name:"生成器"},{name:"过渡"}],left:!0},{name:"进阶",left:!0},{name:"一级节点",children:[{name:"子节点1"},{name:"子节点2"},{name:"子节点3"}]}]}];const V=e();var A={container:"Mindmap_container_zpjgs","svg-wrapper":"Mindmap_svg-wrapper_zpjgs",svg:"Mindmap_svg_zpjgs",trigger:"Mindmap_trigger_zpjgs","add-btn":"Mindmap_add-btn_zpjgs",text:"Mindmap_text_zpjgs",selected:"Mindmap_selected_zpjgs",content:"Mindmap_content_zpjgs",root:"Mindmap_root_zpjgs",edited:"Mindmap_edited_zpjgs",outline:"Mindmap_outline_zpjgs","button-list":"Mindmap_button-list_zpjgs","right-bottom":"Mindmap_right-bottom_zpjgs","top-right":"Mindmap_top-right_zpjgs",disabled:"Mindmap_disabled_zpjgs",gps:"Mindmap_gps_zpjgs",fit:"Mindmap_fit_zpjgs",download:"Mindmap_download_zpjgs",undo:"Mindmap_undo_zpjgs",redo:"Mindmap_redo_zpjgs",close:"Mindmap_close_zpjgs"};class R{constructor(e,t,n,a){this.w=e,this.h=t,this.y=n,this.c=a,this.cs=a.length,this.x=0,this.prelim=0,this.mod=0,this.shift=0,this.change=0,this.tl=null,this.tr=null,this.el=null,this.er=null,this.msel=0,this.mser=0}}function U(e){0===e.cs?(e.el=e,e.er=e,e.msel=e.mser=0):(e.el=e.c[0].el,e.msel=e.c[0].msel,e.er=e.c[e.cs-1].er,e.mser=e.c[e.cs-1].mser)}function G(e){return e.y+e.h}class O{constructor(e,t,n){this.lowY=e,this.index=t,this.next=n}}function P(e,t,n){for(;null!==n&&e>=n.lowY;)n=n.next;return new O(e,t,n)}function H(e,t,n,a){e.c[t].mod+=a,e.c[t].msel+=a,e.c[t].mser+=a,function(e,t,n,a){if(n!==t-1){const o=t-n;e.c[n+1].shift+=a/o,e.c[t].shift-=a/o,e.c[t].change-=a-a/o}}(e,t,n,a)}function K(e){return 0===e.cs?e.tl:e.c[0]}function I(e){return 0===e.cs?e.tr:e.c[e.cs-1]}function q(e,t,n){let a=e.c[t-1],o=a.mod,l=e.c[t],i=l.mod;for(;null!==a&&null!==l;){G(a)>n.lowY&&(n=n.next);const s=o+a.prelim+a.w-(i+l.prelim);s>0&&(i+=s,H(e,t,n.index,s));const r=G(a),d=G(l);r<=d&&(a=I(a),null!==a&&(o+=a.mod)),r>=d&&(l=K(l),null!==l&&(i+=l.mod))}null===a&&null!==l?function(e,t,n,a){const o=e.c[0].el;o.tl=n;const l=a-n.mod-e.c[0].msel;o.mod+=l,o.prelim-=l,e.c[0].el=e.c[t].el,e.c[0].msel=e.c[t].msel}(e,t,l,i):null!==a&&null===l&&function(e,t,n,a){const o=e.c[t].er;o.tr=n;const l=a-n.mod-e.c[t].mser;o.mod+=l,o.prelim-=l,e.c[t].er=e.c[t-1].er,e.c[t].mser=e.c[t-1].mser}(e,t,a,o)}function Y(e){if(0===e.cs)return void U(e);Y(e.c[0]);let t=P(G(e.c[0].el),0,null);for(let n=1;n<e.cs;n++){Y(e.c[n]);const a=G(e.c[n].er);q(e,n,t),t=P(a,n,t)}!function(e){e.prelim=(e.c[0].prelim+e.c[0].mod+e.c[e.cs-1].mod+e.c[e.cs-1].prelim+e.c[e.cs-1].w)/2-e.w/2}(e),U(e)}function F(e,t){t+=e.mod,e.x=e.prelim+t,function(e){let t=0,n=0;for(let a=0;a<e.cs;a++)t+=e.c[a].shift,n+=t+e.c[a].change,e.c[a].mod+=n}(e);for(let n=0;n<e.cs;n++)F(e.c[n],t)}function J(e){Y(e),F(e,0)}class T{constructor(e,t){this.gap=e,this.bottomPadding=t}addBoundingBox(e,t){return{width:e+this.gap,height:t+this.bottomPadding}}removeBoundingBox(e,t){return{x:e+this.gap/2,y:t}}}class W{constructor(e){this.bb=e}layout(e){const t=this.convert(e);J(t);const{boundingBox:n,result:a}=this.assignLayout(t,e);return{result:a,boundingBox:n}}convert(e,t=0){const{width:n,height:a}=this.bb.addBoundingBox(e.width,e.height),o=[];if(e.children&&e.children.length)for(let l=0;l<e.children.length;l++)o[l]=this.convert(e.children[l],t+a);return new R(n,a,t,o)}assignCoordinates(e,t){const{x:n,y:a}=this.bb.removeBoundingBox(e.x,e.y);t.x=n,t.y=a;for(let o=0;o<e.c.length;o++)this.assignCoordinates(e.c[o],t.children[o])}getSize(e,t){const{x:n,y:a,width:o,height:l}=e;if(t||(t={left:n,right:n+o,top:a,bottom:a+l}),t.left=Math.min(t.left,n),t.right=Math.max(t.right,n+o),t.top=Math.min(t.top,a),t.bottom=Math.max(t.bottom,a+l),e.children)for(const i of e.children)this.getSize(i,t);return t}assignLayout(e,t,n){const{x:a,y:o}=this.bb.removeBoundingBox(e.x,e.y);t.x=a,t.y=o;const{width:l,height:i}=t;n||(n={left:a,right:a+l,top:o,bottom:o+i}),n.left=Math.min(n.left,a),n.right=Math.max(n.right,a+l),n.top=Math.min(n.top,o),n.bottom=Math.max(n.bottom,o+i);for(let s=0;s<e.c.length;s++)this.assignLayout(e.c[s],t.children[s],n);return{result:t,boundingBox:n}}}function X(e,t){const n=t(e.name),a={rawData:e,width:n.height,height:n.width,x:0,y:0},{children:o}=e;if(o){const e=a.children=[];o.forEach((n=>{e.push(X(n,t))}))}return a}const Z=e=>{[e.width,e.height]=[e.height,e.width]},Q=e=>{[e.x,e.y]=[e.y,e.x]},ee=e=>{e.parent?(e.dx=e.x-e.parent.x,e.dy=e.y-e.parent.y):(e.dx=0,e.dy=0)},te=(e,t)=>{e.id=t},ne=(e,t,n="0")=>{t.forEach((t=>{t(e,n)}));const{children:a}=e;if(a)for(let o=0;o<a.length;){const e=a[o];"del"===e.id?a.splice(o,1):(ne(e,t,`${n}-${o}`),o+=1)}},ae=(e,t)=>{const n=new T(t,e);return new W(n)};class oe{constructor(e,a,o,l,i=t(n)){this.colorNumber=0,this.gKey=0,this.colorScale=i;const s=X(e,l);this.layout=ae(a,o),this.layout.layout(s),this.data=this.init(s),this.getSize=l}init(e,t="0",n=null,a){const o=e.y,l=e.x;let i="",s=!1,r=o,d=l;n&&(s=n.left,r=n.x,d=n.y,i=a||this.colorScale(`${this.colorNumber+=1}`));const c={x:o,y:l,width:e.height,height:e.width,id:t,gKey:this.gKey+=1,depth:Math.floor(t.length/2),name:e.rawData.name,px:0,py:0,rawData:e.rawData,parent:n,color:i,left:s,dx:o-r,dy:l-d};return e.children&&(c.children=[],e.children.forEach(((e,n)=>{var a;null==(a=c.children)||a.push(this.init(e,`${t}-${n}`,c,i))}))),c}renewColor(e){e.parent&&(e.parent.color?e.color=e.parent.color:e.color||(e.color=this.colorScale(`${this.colorNumber+=1}`)))}setBoundingBox(e,t){this.layout=ae(e,t),this.renew()}find(e){const t=e.split("-").map((e=>~~e));let n=this.data;for(let a=1;a<t.length;a++){if(!n||!n.children)return null;n=n.children[t[a]]||null}return n}rename(e,t){if(e.length>0){const n=this.find(e);if(n&&n.name!==t){n.name=t,n.rawData.name=t;const e=this.getSize(n.name);n.width=e.width,n.height=e.height,this.renew()}return n}return null}moveChild(e,t){var n,a;if(e===t)return null;const o=this.find(e),l=this.find(t),i=t.split("-").pop();if(i&&o&&l){const e=l.parent;null==(n=null==e?void 0:e.children)||n.splice(~~i,1),null==(a=null==e?void 0:e.rawData.children)||a.splice(~~i,1),l.parent=o,l.gKey=this.gKey+=1,l.depth=l.parent.depth+1,1===l.depth&&(l.color=this.colorScale(`${this.colorNumber+=1}`)),o.children?o.children.push(l):o.children=[l],o.rawData.children?o.rawData.children.push(l.rawData):o.rawData.children=[l.rawData],this.renew(te,this.renewColor)}return l}moveSibling(e,t,n=0){const a=e.split("-"),o=t.split("-");let l=a.pop(),i=o.pop();if(e===t||a.length!==o.length||!l||!i)return null;const s=this.find(e);if(s&&s.parent){l=parseInt(l,10),i=parseInt(i,10),l<i&&(i-=1);const{children:e}=s.parent,{children:t}=s.parent.rawData;if(e&&t)return e.splice(l,1),e.splice(i+n,0,s),t.splice(l,1),t.splice(i+n,0,s.rawData),this.renew(te),s}return null}add(e,t){const n=this.find(e);if(n){n.children||(n.children=[]),n.rawData.children||(n.rawData.children=[]);const e=this.getSize(t),a={name:t},o=n.color?n.color:this.colorScale(`${this.colorNumber+=1}`),l={id:`${n.id}-${n.children.length}`,name:t,rawData:a,parent:n,left:n.left,color:o,gKey:this.gKey+=1,width:e.width,height:e.height,depth:n.depth+1,x:0,y:0,dx:0,dy:0,px:0,py:0};return n.children.push(l),n.rawData.children.push(a),this.renew(),l}return null}renew(...e){ne(this.data,[Z]),this.layout.layout(this.data);const t=[Z,Q,ee];ne(this.data,t.concat(e))}delete(e){const t=e.split("-");if(!(t.length>=2))throw new Error("暂不支持删除根节点");{const e=t.pop(),n=this.find(t.join("-"));e&&n&&n.children&&(n.children[~~e].id="del"),this.renew(te)}}}const le=e=>{const t=e.split("\n");return t.length>2&&""===t[t.length-1]&&t.pop(),t},ie=(e,t)=>a().duration(e).ease(t);function se(){var e,t;return null==(t=null==(e=this.parentNode)?void 0:e.parentNode)?void 0:t.parentNode}const re=l().source((e=>e.source)).target((e=>e.target)),de=i().curve(s);let ce=re;const ue=({source:e,target:t})=>de([e,t]),he=12,pe=2,me=he+2*pe;let ge=4,ve=18,fe=Math.min(ve/2-1,10),ye=!1;V.on("branch",(e=>ge=e||ge)),V.on("sharp-corner",(e=>{ye=e||!1,ce=e?ue:re})),V.on("gap",(e=>{if(!e)return;const t=e[0];ve=e[1],fe=Math.min(ve/2-1,10),fe=Math.min(t/2-1,fe)}));const xe=e=>{const t=["node"];return e&&(t.push(`depth-${e.depth}`),0===e.depth&&t.push(A.root)),t},be=e=>`translate(${e.dx+e.px},${e.dy+e.py})`,we=e=>e.id,$e=e=>{const t=le(e.name),n=e.height/t.length;return t.map((e=>({name:e,height:n})))},Me=e=>{let t=0,n=0;const a=Math.max(fe-3,0),o=ge/2;let l=o;e.parent&&(t=e.parent.width,n=e.parent.height,0===e.parent.depth&&(ye||(t/=2),n/=2,l=0));const i=[-e.dx+t-e.px,-e.dy+n+l-e.py],s=[0,e.height+o];return`${ce({source:i,target:s})}L${e.width+a},${s[1]}`},_e=(e,t)=>{const n=e.attr("class",(e=>xe(e).join(" "))).attr("data-id",we);(t?n.transition(t):n).attr("transform",be)},Be=e=>{e.attr("alignment-baseline","text-before-edge").text((e=>e.name||" ")).attr("x",0).attr("dy",((e,t)=>t?e.height:0))},ke=(e,t,n=4)=>{e.attr("x",-t).attr("y",-t).attr("rx",n).attr("ry",n).attr("width",(e=>e.width+2*t)).attr("height",(e=>e.height+2*t))},Le=(e,t)=>{e.attr("class",A["add-btn"]).attr("transform",(e=>((e,t)=>{const n=0===e.depth?e.height/2:e.height+ge/2;return`translate(${e.width+t+me/2+8},${n})`})(e,t)))},ze=(e,t)=>{e.attr("class",A.trigger).attr("x",-t).attr("y",-t).attr("width",(e=>e.width+2*t+8+me)).attr("height",(e=>e.height+2*t))},Ce=(e,t)=>{const n=e.attr("stroke",(e=>e.color)).attr("stroke-width",ge);(t?n.transition(t):n).attr("d",(e=>Me(e)))},Ee=e=>{const t=e.append("tspan");return Be(t),t},je=e=>(Be(e),e),Ne=e=>{const t=e.append("g");return(e=>{const t=-pe-he/2,n=he+2*pe;e.attr("x",t).attr("y",t).attr("rx",4).attr("ry",4).attr("width",n).attr("height",n)})(t.append("rect")),t.append("path").attr("d",((e,t)=>{const n=-t/2,a=-e/2,o=e/2,l=t/2;return`M${l},${o}H${o}V${l}H${a}V${o}H${n}V${a}H${a}V${n}H${o}V${a}H${l}V${o}Z`})(2,he)),t};function Se(){const e=this.querySelector(`g.${A["add-btn"]}`);e&&(e.style.opacity="1")}function De(){const e=this.querySelector(`g.${A["add-btn"]}`);e&&(e.style.opacity="0")}var Ve=r({name:"contextmenu",props:{position:{default:{top:0,left:0}},groups:Array},emits:["click-item"],setup(e,t){const n=d(!1),a=c();V.on("showContextmenu",(e=>n.value=e));const o=()=>n.value=!1;return{style:a,show:n,close:o,onClick:e=>{o(),t.emit("click-item",e)}}}});var Ae={container:"Contextmenu_container_154ic",menu:"Contextmenu_menu_154ic",disabled:"Contextmenu_disabled_154ic"};(Ve.__cssModules={}).$style=Ae,Ve.render=function(e,t,n,a,o,l){return u((f(),p("div",{class:e.style.container},[m("div",{onMousedown:t[1]||(t[1]=(...t)=>e.close&&e.close(...t))},null,32),m("div",{id:e.style.menu,style:{top:e.position.top+"px",left:e.position.left+"px"}},[(f(!0),p(g,null,v(e.groups,((t,n)=>(f(),p("ul",{key:n},[(f(!0),p(g,null,v(t,(t=>(f(),p("li",{class:t.disabled?e.style.disabled:"",key:t.name,onClick:n=>e.onClick(t.name)},y(t.title),11,["onClick"])))),128))])))),128))],12,["id"])],2)),[[h,e.show]])};var Re=r({name:"Mindmap",components:{Contextmenu:Ve},props:{modelValue:{type:Array,required:!0},width:Number,height:Number,xGap:{type:Number,default:50},yGap:{type:Number,default:18},branch:{type:Number,default:4},scaleExtent:{default:()=>[.1,8]},centerBtn:Boolean,fitBtn:Boolean,downloadBtn:Boolean,undoBtn:Boolean,addNodeBtn:Boolean,edit:Boolean,drag:Boolean,keyboard:Boolean,contextmenu:Boolean,zoom:Boolean,sharpCorner:Boolean},setup(e){let t=d(k);const n=d({left:0,top:0}),a=d(),l=d(),i=d(),s=d(),r=d(),c=d(),u=d(),h=d(),p=d(),m=d(),g=x().on("zoom",(function(e){if(!h.value)return;t.value=e.transform,h.value.attr("transform",e.transform.toString())})).scaleExtent(e.scaleExtent),v=b().container(se).on("drag",(function(e,t){var n;const a=null==(n=this.parentNode)?void 0:n.parentNode;if(C.value=!1,!h.value)return;P(a,t,[e.x-t.x,e.y-t.y]);const o=B(e,i.value);o[1]+=y.data.y;const l=h.value.selectAll("g.node").filter((e=>{if(e!==t&&e!==t.parent&&!e.id.startsWith(t.id)){const t={x0:e.x-fe,x1:e.x+e.width+fe,y0:e.y-fe,y1:e.y+e.height+fe};return o[0]>t.x0&&o[1]>t.y0&&o[0]<t.x1&&o[1]<t.y1}return!1})),s=Array.from(document.getElementsByClassName(A.outline)),r=l.node();s.forEach((e=>{e!==r&&e.classList.remove(A.outline)})),null==r||r.classList.add(A.outline)})).on("end",(function(e,t){var n;const a=null==(n=this.parentNode)?void 0:n.parentNode;C.value=!0;const o=document.getElementsByClassName(A.outline)[0];if(o){o.classList.remove(A.outline);const e=o.getAttribute("data-id");if(!e)throw new Error("outline data-id null");return t.px=0,t.py=0,void ee(e,t.id)}const l=a.parentNode;let i=t,s=t;if(M(l).selectAll(`g.${xe(t).join(".")}`).filter((e=>e!==t)).each((e=>{e.y>t.y&&e.y<t.y+t.py&&e.y>s.y&&(s=e),e.y<t.y&&e.y>t.y+t.py&&e.y<i.y&&(i=e)})),i!==t)return t.px=0,t.py=0,void te(t.id,i.id);if(s!==t)return t.px=0,t.py=0,void te(t.id,s.id,1);P(a,t,[0,0],500)})),f=new ResizeObserver((e=>{if(!m.value)return;const t=e[0],n=t.target,a=2*(parseInt(getComputedStyle(n).paddingLeft||"0",10)+parseInt(getComputedStyle(n.parentNode).borderTopWidth||"0",10));m.value.attr("width",t.contentRect.width+a).attr("height",t.contentRect.height+a)}));let y,z=!1;const C=d(!0),E=w((()=>[[{title:"放大",name:"zoomin",disabled:t.value.k>=e.scaleExtent[1]},{title:"缩小",name:"zoomout",disabled:t.value.k<=e.scaleExtent[0]},{title:"缩放至合适大小",name:"zoomfit",disabled:!1}],[{title:"全选",name:"selectall",disabled:!0}]])),j=[[{title:"新建子节点",name:"add",disabled:!1}],[{title:"删除节点",name:"delete",disabled:!1}],[{title:"全选",name:"selectall",disabled:!0}],[{title:"折叠节点",name:"collapse",disabled:!0},{title:"展开节点",name:"expand",disabled:!0}]],N=d(!0);$((()=>{l.value&&i.value&&s.value&&r.value&&c.value&&(u.value=M(l.value),h.value=M(i.value),p.value=M(s.value).attr("width",0).attr("height",0),m.value=M(r.value),f.observe(c.value),y=new oe(JSON.parse(JSON.stringify(e.modelValue[0])),e.xGap,e.yGap,G),U(),m.value.raise(),c.value.addEventListener("blur",I),c.value.addEventListener("mousedown",(e=>e.stopPropagation())),re(),de(),u.value.on("mousedown",(()=>{const e=document.getElementsByClassName(A.selected)[0];null==e||e.classList.remove(A.selected)})),J(e.zoom),Z(e.contextmenu))})),_((()=>e.branch),(e=>V.emit("branch",e))),_((()=>e.sharpCorner),(e=>{V.emit("sharp-corner",e),U()})),_((()=>[e.branch,e.addNodeBtn]),(()=>U())),_((()=>[e.xGap,e.yGap]),(e=>{V.emit("gap",e),y.setBoundingBox(e[0],e[1]),U()})),_((()=>[e.drag,e.edit]),(e=>{X(e[0]||e[1]),W(e[0]),T(e[1])})),_((()=>e.zoom),(e=>J(e))),_(C,(e=>{var t;null==(t=h.value)||t.selectAll(`g.${A["add-btn"]}`).style("display",e?"":"none")})),_((()=>e.contextmenu),(e=>Z(e)));const S=e=>{const t=Ne(e);return t.on("click",Y),t},D=t=>{var n;const a=!(null==(n=t.data()[0])?void 0:n.depth),o=t.append("g");_e(o),Ce(o.append("path"));const l=o.append("g").attr("class",A.content),i=l.append("rect"),s=l.append("g").attr("class",A.text),r=s.append("rect"),d=s.append("text").selectAll("tspan").data($e).enter().append("tspan");let c;return Be(d),e.addNodeBtn&&(c=S(l)),a?(ze(i,10),ke(r,10,6),c&&Le(c,10)):(ze(i,fe),ke(r,fe),c&&Le(c,fe)),H(o,a),o.each(((e,t)=>{e.children&&U(e.children,o.filter(((e,n)=>t===n)))})),l.raise(),o},R=t=>{var n;const a=!(null==(n=t.data()[0])?void 0:n.depth),o=ie(500,L);_e(t,o),Ce(t.select(":scope > path"),o);const l=t.select(`:scope > g.${A.content}`),i=l.select(":scope > rect"),s=l.select(`g.${A.text}`),r=s.select("rect");s.select("text").selectAll("tspan").data($e).join(Ee,je,(e=>e.remove()));let d=l.select(`g.${A["add-btn"]}`);return e.addNodeBtn?d.node()||(d=S(l)):d.remove(),a?(ze(i,10),ke(r,10,6),Le(d,10)):(ze(i,fe),ke(r,fe),Le(d,fe)),t.each(((e,n)=>{e.children&&U(e.children,t.filter(((e,t)=>n===t)))})),l.raise(),t},U=(e=[y.data],t=h.value)=>{t.selectAll(`g.${xe(e[0]).join(".")}`).data(e,(e=>e.gKey)).join(D,R)},G=e=>{if(!p.value)throw new Error("asstSvg undefined");const t=le(e),n=p.value.append("text");n.selectAll("tspan").data(t).enter().append("tspan").text((e=>e)).attr("x",0);const a=n.node().getBBox();return n.remove(),{width:Math.max(a.width,22),height:Math.max(a.height,22)*t.length}};function O(e){const t=e instanceof SVGGElement?e:document.querySelector(`g[data-id='${we(e)}']`),n=document.getElementsByClassName(A.selected)[0];if(!t)throw new Error(`g[data-id='${we(e)}'] is null`);n?n!==t?(n.classList.remove(A.selected),t.classList.add(A.selected)):z=!0:t.classList.add(A.selected)}const P=(e,t,n,a=0)=>{const o=ie(a,L);t.px=n[0],t.py=n[1],M(e).transition(o).attr("transform",be),M(`g[data-id='${we(t)}'] > path`).transition(o).attr("d",(e=>Me(e)))},H=(t,n)=>{if(e.drag||e.edit){const a=t.select(`:scope > g.${A.content} > g.${A.text}`);a.on("mousedown",q),e.drag&&!n&&v(a),e.edit&&a.on("click",K)}e.addNodeBtn&&t.select(`:scope > g.${A.content}`).on("mouseenter",Se).on("mouseleave",De)};function K(e,t){var n,a;const o=null==(n=this.parentNode)?void 0:n.parentNode;if(z&&m.value&&c.value){o.classList.add(A.edited),z=!1,m.value.attr("x",t.x-2).attr("y",t.y-y.data.y-2).attr("data-id",t.id).attr("data-name",t.name).style("display","");const e=c.value;e.textContent=t.name,e.focus(),null==(a=getSelection())||a.selectAllChildren(e)}}const I=()=>{var e;if(null==(e=document.getElementsByClassName(A.edited)[0])||e.classList.remove(A.edited,A.selected),r.value&&c.value){r.value.style.display="none";const e=r.value.getAttribute("data-id"),t=r.value.getAttribute("data-name"),n=c.value.textContent;e&&n&&n!==t&&Q(e,n)}},q=(e,t)=>{e.stopPropagation(),O(t)},Y=(e,t)=>{const n=ne(t.id,"");if(!h.value||!n)return;const a=h.value.selectAll(`g[data-id='${we(n)}'] g.${A.text}`).node();a&&(z=!0,K.call(a,e,n))},F=e=>{if(e.preventDefault(),!a.value)return;const t=((e,t)=>{const{pageX:n,pageY:a}=t,o=e.getBoundingClientRect();return{left:n-(o.left+window.pageXOffset),top:a-(o.top+window.pageYOffset)}})(a.value,e);n.value=t;const o=e.composedPath().find((e=>{var t;return null==(t=e.classList)?void 0:t.contains("node")}));o&&(o.classList.contains(A.selected)||O(o),j[1][0].disabled=!!o.classList.contains(A.root)),N.value=!o,V.emit("showContextmenu",!0)},J=e=>{u.value&&(e?(g(u.value),u.value.on("dblclick.zoom",null)):u.value.on(".zoom",null))},T=e=>{if(!c.value||!h.value)return;const t=h.value.selectAll(`g.${A.text}`);e?t.on("click",K):t.on("click",null)},W=e=>{if(!h.value)return;const t=h.value.selectAll(`g.node:not(.${A.root}) > g > g.${A.text}`);e?v(t):t.on(".drag",null)},X=e=>{if(!h.value)return;const t=h.value.selectAll(`g.${A.text}`);e?t.on("mousedown",q):t.on("mousedown",null)},Z=e=>{a.value&&(e?a.value.addEventListener("contextmenu",F):a.value.removeEventListener("contextmenu",F))},Q=(e,t)=>{y.rename(e,t),U()},ee=(e,t)=>{y.moveChild(e,t),U()},te=(e,t,n=0)=>{y.moveSibling(e,t,n),U()},ne=(e,t)=>{const n=y.add(e,t);return U(),n},ae=e=>{y.delete(e),U()},re=()=>{if(!u.value)return;const e=y.data;g.translateTo(u.value,0+e.width/2,0+e.height/2)},de=()=>{if(!u.value||!i.value||!l.value)return;const e=i.value.getBBox(),t=l.value.getBoundingClientRect(),n=Math.min(t.width/e.width,t.height/e.height),a=t.width/2,o=t.height/2,s=e.width*n/2,r=e.height*n/2,d=k.translate(-e.x*n+a-s,-e.y*n+o-r).scale(n);g.transform(u.value,d)},ce=e=>{u.value&&g.scaleBy(u.value,e?1.1:.9)};return{wrapperEle:a,svgEle:l,gEle:i,style:A,asstSvgEle:s,foreignEle:r,foreignDivEle:c,centerView:re,fitView:de,download:()=>{var e,t;a.value&&(e=a.value,t=y.data.name,o(e).then((e=>{const n=e.toDataURL(),a=open();a&&(a.document.write(`<img src='${n}'>`),a.document.title=t,a.document.close())})))},showViewMenu:N,viewMenu:E,nodeMenu:j,contextmenuPos:n,onClickMenu:e=>{if("zoomfit"===e)de();else if("zoomin"===e)ce(!0);else if("zoomout"===e)ce(!1);else if("add"===e){const e=M(`.${A.selected}`).data()[0];Y(new MouseEvent("click"),e)}else if("delete"===e){const e=M(`.${A.selected}`).data()[0];ae(e.id)}}}}});const Ue={ref:"gEle"},Ge={ref:"foreignEle",style:{display:"none"}},Oe={ref:"foreignDivEle",contenteditable:""},Pe={ref:"asstSvgEle"};Re.render=function(e,t,n,a,o,l){const i=z("contextmenu");return f(),p("div",{class:e.style.container},[m("div",{id:e.style["svg-wrapper"],ref:"wrapperEle"},[(f(),p("svg",{class:e.style.svg,ref:"svgEle"},[m("g",Ue,[(f(),p("foreignObject",Ge,[m("div",Oe,null,512)],512))],512)],2))],8,["id"]),(f(),p("svg",Pe,null,512)),m("div",{class:[e.style["button-list"],e.style["right-bottom"]]},[e.centerBtn?(f(),p("button",{key:0,onClick:t[1]||(t[1]=t=>e.centerView())},[m("i",{class:e.style.gps},null,2)])):C("",!0),e.fitBtn?(f(),p("button",{key:1,onClick:t[2]||(t[2]=t=>e.fitView())},[m("i",{class:e.style.fit},null,2)])):C("",!0),e.downloadBtn?(f(),p("button",{key:2,onClick:t[3]||(t[3]=t=>e.download())},[m("i",{class:e.style.download},null,2)])):C("",!0)],2),e.contextmenu?(f(),p(i,{key:0,position:e.contextmenuPos,groups:e.showViewMenu?e.viewMenu:e.nodeMenu,onClickItem:e.onClickMenu},null,8,["position","groups","onClickItem"])):C("",!0)],2)};var He=r({name:"App",components:{Mindmap:Re},setup(){const e=E({"center-btn":{value:!0},"fit-btn":{value:!0},"undo-btn":{value:!1,disabled:!0},"download-btn":{value:!0},"add-node-btn":{value:!0},keyboard:{value:!1,disabled:!0},zoom:{value:!0},drag:{value:!0},edit:{value:!0},contextmenu:{value:!0},"sharp-corner":{value:!1},vertical:{value:!1,disabled:!0}}),t=E({branch:{value:4,min:0,max:10},"x-gap":{value:50,min:0,max:100},"y-gap":{value:18,min:0,max:100}});return{learn:D,checkboxList:e,rangeList:t}}});const Ke={class:"container"},Ie=m("div",{class:"left-top"},[m("a",{href:"https://github.com/hellowuxin/vue3-mindmap",target:"_blank"},"GitHub")],-1),qe=m("div",{class:"right-top"},[m("span",null,"Props")],-1),Ye={class:"right-bottom"};He.render=function(e,t,n,a,o,l){const i=z("mindmap");return f(),p("div",Ke,[Ie,qe,m(i,{class:"left-bottom",modelValue:e.learn,"onUpdate:modelValue":t[1]||(t[1]=t=>e.learn=t),branch:e.rangeList.branch.value,"x-gap":e.rangeList["x-gap"].value,"y-gap":e.rangeList["y-gap"].value,zoom:e.checkboxList.zoom.value,"fit-btn":e.checkboxList["fit-btn"].value,"center-btn":e.checkboxList["center-btn"].value,"download-btn":e.checkboxList["download-btn"].value,drag:e.checkboxList.drag.value,edit:e.checkboxList.edit.value,"add-node-btn":e.checkboxList["add-node-btn"].value,"sharp-corner":e.checkboxList["sharp-corner"].value,contextmenu:e.checkboxList.contextmenu.value},null,8,["modelValue","branch","x-gap","y-gap","zoom","fit-btn","center-btn","download-btn","drag","edit","add-node-btn","sharp-corner","contextmenu"]),m("div",Ye,[(f(!0),p(g,null,v(e.checkboxList,((e,t)=>(f(),p("div",{key:t},[u(m("input",{type:"checkbox",name:t.toString(),"onUpdate:modelValue":t=>e.value=t,disabled:e.disabled},null,8,["name","onUpdate:modelValue","disabled"]),[[j,e.value]]),m("label",{for:t.toString()},y(t),9,["for"])])))),128)),(f(!0),p(g,null,v(e.rangeList,((e,t)=>(f(),p("div",{key:t},[u(m("input",{type:"range",name:t,"onUpdate:modelValue":t=>e.value=t,min:e.min,max:e.max},null,8,["name","onUpdate:modelValue","min","max"]),[[N,e.value,void 0,{number:!0}]]),m("label",{for:t},y(t)+"（"+y(e.value)+"）",9,["for"])])))),128))])])},S(He).mount("#app");
