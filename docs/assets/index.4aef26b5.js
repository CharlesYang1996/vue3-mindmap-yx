import{m as t,o as e,P as n,l as a,r as l,p as o,c as s,a as i,b as r,s as c,z as d,i as u,t as h,d as p,h as m,e as g,f as v,u as f,w as x,v as y,g as b,j as w,F as _,k as $,n as M,q as k,x as B,y as L,A as C,B as E,C as S,D,E as N,G as z,H as V,I as A}from"./vendor.fb85e1c6.js";var j=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",get svg(){return Bt},get g(){return Lt},get asstSvg(){return Ct},get foreign(){return Et}});!function(t=".",e="__import__"){try{self[e]=new Function("u","return import(u)")}catch(n){const a=new URL(t,location),l=t=>{URL.revokeObjectURL(t.src),t.remove()};self[e]=t=>new Promise(((n,o)=>{const s=new URL(t,a);if(self[e].moduleMap[s])return n(self[e].moduleMap[s]);const i=new Blob([`import * as m from '${s}';`,`${e}.moduleMap['${s}']=m;`],{type:"text/javascript"}),r=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(i),onerror(){o(new Error(`Failed to import: ${t}`)),l(r)},onload(){n(self[e].moduleMap[s]),l(r)}});document.head.appendChild(r)})),self[e].moduleMap={}}}("/vue3-mindmap/assets/");var G=[{name:"如何学习D3",children:[{name:"预备知识",children:[{name:"HTML & CSS"},{name:"JavaScript"},{name:"DOM"},{name:"SVG"},{name:"test\ntest"}]},{name:"安装",collapse:!0,children:[{name:"折叠节点"}]},{name:"入门",children:[{name:"选择集"},{name:"test"},{name:"绑定数据"},{name:"添加删除元素"},{name:"简单图形",children:[{name:"柱形图"},{name:"折线图"},{name:"散点图"}]},{name:"比例尺"},{name:"生成器"},{name:"过渡"}],left:!0},{name:"进阶",left:!0},{name:"一级节点",children:[{name:"子节点1"},{name:"子节点2"},{name:"子节点3"}]}]}];const P=t();var R={container:"Mindmap_container_7uix5","svg-wrapper":"Mindmap_svg-wrapper_7uix5",svg:"Mindmap_svg_7uix5",trigger:"Mindmap_trigger_7uix5",dragging:"Mindmap_dragging_7uix5","add-btn":"Mindmap_add-btn_7uix5",hidden:"Mindmap_hidden_7uix5","expand-btn":"Mindmap_expand-btn_7uix5",text:"Mindmap_text_7uix5",selected:"Mindmap_selected_7uix5",content:"Mindmap_content_7uix5",root:"Mindmap_root_7uix5",edited:"Mindmap_edited_7uix5",outline:"Mindmap_outline_7uix5",collapse:"Mindmap_collapse_7uix5","button-list":"Mindmap_button-list_7uix5","right-bottom":"Mindmap_right-bottom_7uix5","right-top":"Mindmap_right-top_7uix5",disabled:"Mindmap_disabled_7uix5",gps:"Mindmap_gps_7uix5",fit:"Mindmap_fit_7uix5",download:"Mindmap_download_7uix5",prev:"Mindmap_prev_7uix5",next:"Mindmap_next_7uix5",close:"Mindmap_close_7uix5"};class U{constructor(t,e,n,a){this.w=t,this.h=e,this.y=n,this.c=a,this.cs=a.length,this.x=0,this.prelim=0,this.mod=0,this.shift=0,this.change=0,this.tl=null,this.tr=null,this.el=null,this.er=null,this.msel=0,this.mser=0}}function O(t){0===t.cs?(t.el=t,t.er=t,t.msel=t.mser=0):(t.el=t.c[0].el,t.msel=t.c[0].msel,t.er=t.c[t.cs-1].er,t.mser=t.c[t.cs-1].mser)}function H(t){return t.y+t.h}class K{constructor(t,e,n){this.lowY=t,this.index=e,this.next=n}}function I(t,e,n){for(;null!==n&&t>=n.lowY;)n=n.next;return new K(t,e,n)}function q(t,e,n,a){t.c[e].mod+=a,t.c[e].msel+=a,t.c[e].mser+=a,function(t,e,n,a){if(n!==e-1){const l=e-n;t.c[n+1].shift+=a/l,t.c[e].shift-=a/l,t.c[e].change-=a-a/l}}(t,e,n,a)}function Y(t){return 0===t.cs?t.tl:t.c[0]}function T(t){return 0===t.cs?t.tr:t.c[t.cs-1]}function F(t,e,n){let a=t.c[e-1],l=a.mod,o=t.c[e],s=o.mod;for(;null!==a&&null!==o;){H(a)>n.lowY&&(n=n.next);const i=l+a.prelim+a.w-(s+o.prelim);i>0&&(s+=i,q(t,e,n.index,i));const r=H(a),c=H(o);r<=c&&(a=T(a),null!==a&&(l+=a.mod)),r>=c&&(o=Y(o),null!==o&&(s+=o.mod))}null===a&&null!==o?function(t,e,n,a){const l=t.c[0].el;l.tl=n;const o=a-n.mod-t.c[0].msel;l.mod+=o,l.prelim-=o,t.c[0].el=t.c[e].el,t.c[0].msel=t.c[e].msel}(t,e,o,s):null!==a&&null===o&&function(t,e,n,a){const l=t.c[e].er;l.tr=n;const o=a-n.mod-t.c[e].mser;l.mod+=o,l.prelim-=o,t.c[e].er=t.c[e-1].er,t.c[e].mser=t.c[e-1].mser}(t,e,a,l)}function W(t){if(0===t.cs)return void O(t);W(t.c[0]);let e=I(H(t.c[0].el),0,null);for(let n=1;n<t.cs;n++){W(t.c[n]);const a=H(t.c[n].er);F(t,n,e),e=I(a,n,e)}!function(t){t.prelim=(t.c[0].prelim+t.c[0].mod+t.c[t.cs-1].mod+t.c[t.cs-1].prelim+t.c[t.cs-1].w)/2-t.w/2}(t),O(t)}function X(t,e){e+=t.mod,t.x=t.prelim+e,function(t){let e=0,n=0;for(let a=0;a<t.cs;a++)e+=t.c[a].shift,n+=e+t.c[a].change,t.c[a].mod+=n}(t);for(let n=0;n<t.cs;n++)X(t.c[n],e)}function J(t){W(t),X(t,0)}class Z{constructor(t,e){this.gap=t,this.bottomPadding=e}addBoundingBox(t,e){return{width:t+this.gap,height:e+this.bottomPadding}}removeBoundingBox(t,e){return{x:t+this.gap/2,y:e}}}class Q{constructor(t){this.bb=t}layout(t){const e=this.convert(t);J(e);const{boundingBox:n,result:a}=this.assignLayout(e,t);return{result:a,boundingBox:n}}convert(t,e=0){const{width:n,height:a}=this.bb.addBoundingBox(t.width,t.height),l=[];if(t.children&&t.children.length)for(let o=0;o<t.children.length;o++)l[o]=this.convert(t.children[o],e+a);return new U(n,a,e,l)}assignCoordinates(t,e){const{x:n,y:a}=this.bb.removeBoundingBox(t.x,t.y);e.x=n,e.y=a;for(let l=0;l<t.c.length;l++)this.assignCoordinates(t.c[l],e.children[l])}getSize(t,e){const{x:n,y:a,width:l,height:o}=t;if(e||(e={left:n,right:n+l,top:a,bottom:a+o}),e.left=Math.min(e.left,n),e.right=Math.max(e.right,n+l),e.top=Math.min(e.top,a),e.bottom=Math.max(e.bottom,a+o),t.children)for(const s of t.children)this.getSize(s,e);return e}assignLayout(t,e,n){const{x:a,y:l}=this.bb.removeBoundingBox(t.x,t.y);e.x=a,e.y=l;const{width:o,height:s}=e;n||(n={left:a,right:a+o,top:l,bottom:l+s}),n.left=Math.min(n.left,a),n.right=Math.max(n.right,a+o),n.top=Math.min(n.top,l),n.bottom=Math.max(n.bottom,l+s);for(let i=0;i<t.c.length;i++)this.assignLayout(t.c[i],e.children[i],n);return{result:e,boundingBox:n}}}function tt(t,e){const n=e(t.name),a={rawData:t,width:n.height,height:n.width,x:0,y:0,children:[],_children:[]},{children:l,collapse:o}=t;if(l){const t=[];o?a._children=t:a.children=t,l.forEach((n=>{t.push(tt(n,e))}))}return a}const et=t=>{[t.width,t.height]=[t.height,t.width]},nt=t=>{[t.x,t.y]=[t.y,t.x]},at=t=>{t.parent?(t.dx=t.x-t.parent.x,t.dy=t.y-t.parent.y):(t.dx=0,t.dy=0)},lt=(t,e)=>{t.id=e},ot=(t,e,n="0")=>{var a;e.forEach((e=>{e(t,n)}));const{children:l}=t;if(l)for(let o=0;o<l.length;){const s=l[o];"del"===s.id?(l.splice(o,1),null==(a=t.rawData.children)||a.splice(o,1)):(ot(s,e,`${n}-${o}`),o+=1)}},st=(t,e)=>{const n=new Z(e,t);return new Q(n)};class it{constructor(t,a,l,o,s=e(n)){this.colorNumber=0,this.gKey=0,this.colorScale=s,this.getSize=o;const i=tt(t,o);this.layout=st(a,l),this.layout.layout(i),this.data=this.init(i)}init(t,e="0",n=null,a){const l=t.y,o=t.x;let s="",i=!1,r=l,c=o;n&&(i=n.left,r=n.x,c=n.y,s=a||this.colorScale(`${this.colorNumber+=1}`));const d={x:l,y:o,width:t.height,height:t.width,id:e,gKey:this.gKey+=1,depth:Math.floor(e.length/2),name:t.rawData.name,px:0,py:0,rawData:t.rawData,parent:n,color:s,left:i,collapse:!!t.rawData.collapse,dx:l-r,dy:o-c,children:[],_children:[]};return t.children&&!d.collapse&&t.children.forEach(((t,n)=>{d.children.push(this.init(t,`${e}-${n}`,d,s))})),t._children&&d.collapse&&t._children.forEach(((t,n)=>{d._children.push(this.init(t,`${e}-${n}`,d,s))})),d}renewColor(t){t.parent&&(t.parent.color?t.color=t.parent.color:t.color||(t.color=this.colorScale(`${this.colorNumber+=1}`)))}setBoundingBox(t,e){this.layout=st(t,e),this.renew()}find(t){const e=t.split("-").map((t=>~~t));let n=this.data;for(let a=1;a<e.length;a++){if(!n||!n.children)return null;n=n.children[e[a]]||null}return n}rename(t,e){if(t.length>0){const n=this.find(t);if(n&&n.name!==e){n.name=e,n.rawData.name=e;const t=this.getSize(n.name);n.width=t.width,n.height=t.height,this.renew()}return n}return null}moveChild(t,e){var n,a;if(t===e)return null;const l=this.find(t),o=this.find(e),s=e.split("-").pop();if(s&&l&&o){const t=o.parent;null==(n=null==t?void 0:t.children)||n.splice(~~s,1),null==(a=null==t?void 0:t.rawData.children)||a.splice(~~s,1),o.parent=l,o.gKey=this.gKey+=1,o.depth=o.parent.depth+1,1===o.depth&&(o.color=this.colorScale(`${this.colorNumber+=1}`)),l.children?l.children.push(o):l.children=[o],l.rawData.children?l.rawData.children.push(o.rawData):l.rawData.children=[o.rawData],this.renew(lt,this.renewColor)}return o}moveSibling(t,e,n=0){const a=t.split("-"),l=e.split("-");let o=a.pop(),s=l.pop();if(t===e||a.length!==l.length||!o||!s)return null;const i=this.find(t);if(i&&i.parent){o=parseInt(o,10),s=parseInt(s,10),o<s&&(s-=1);const{children:t}=i.parent,{children:e}=i.parent.rawData;if(t&&e)return t.splice(o,1),t.splice(s+n,0,i),e.splice(o,1),e.splice(s+n,0,i.rawData),this.renew(lt),i}return null}add(t,e){const n=this.find(t);if(n){n.children||(n.children=[]),n.rawData.children||(n.rawData.children=[]);const t=this.getSize(e),a={name:e},l=n.color?n.color:this.colorScale(`${this.colorNumber+=1}`),o={id:`${n.id}-${n.children.length}`,name:e,rawData:a,parent:n,left:n.left,collapse:!1,color:l,gKey:this.gKey+=1,width:t.width,height:t.height,depth:n.depth+1,x:0,y:0,dx:0,dy:0,px:0,py:0,children:[],_children:[]};return n.children.push(o),n.rawData.children.push(a),this.renew(),o}return null}expand(t){return this.eoc(t,!1)}collapse(t){return this.eoc(t,!0)}eoc(t,e){const n=this.find(t);return n&&(n.collapse=e,n.rawData.collapse=e,[n._children,n.children]=[n.children,n._children],this.renew()),n}renew(...t){ot(this.data,[et]),this.layout.layout(this.data);const e=[et,nt,at];ot(this.data,e.concat(t))}delete(t){const e=t.split("-");if(!(e.length>=2))throw new Error("暂不支持删除根节点");{const t=e.pop(),n=this.find(e.join("-"));t&&n&&n.children&&(n.children[~~t].id="del"),this.renew(lt)}}}let rt;P.on("mmdata",(t=>rt=t||rt));const ct=new class{constructor(t=20){this.length=t,this.snapshots=[],this.cursor=-1}get hasPrev(){return this.cursor>0}get hasNext(){return this.snapshots.length>this.cursor+1}snap(t){const e=a.cloneDeep(t);for(;this.cursor<this.snapshots.length-1;)this.snapshots.pop();this.snapshots.push(e),this.snapshots.length>this.length&&this.snapshots.shift(),this.cursor=this.snapshots.length-1}prev(){return this.hasPrev?(this.cursor-=1,a.cloneDeep(this.snapshots[this.cursor])):null}next(){return this.hasNext?(this.cursor+=1,a.cloneDeep(this.snapshots[this.cursor])):null}},dt=l(!1),ut=l(!1),ht=l(),pt=l(),mt=l(),gt=l(),vt=l(),ft=l();function xt(){const t=this.querySelector(`g.${R["add-btn"]}`);t&&(t.style.opacity="1")}function yt(){const t=this.querySelector(`g.${R["add-btn"]}`);t&&(t.style.opacity="0")}const bt=(t,e)=>{t.stopPropagation(),_e(e)};function wt(t,e){var n;const a=null==(n=this.parentNode)?void 0:n.parentNode;pt.value&&pt.value.classList.add(R.dragging);const{g:l}=j;if(!l)return;Me(a,e,[t.x-e.x,t.y-e.y]);const s=o(t,mt.value);s[1]+=rt.data.y;const i=l.selectAll("g.node").filter((t=>{if(t!==e&&t!==e.parent&&!t.id.startsWith(e.id)){const e={x0:t.x-Wt,x1:t.x+t.width+Wt,y0:t.y-Wt,y1:t.y+t.height+Wt};return s[0]>e.x0&&s[1]>e.y0&&s[0]<e.x1&&s[1]<e.y1}return!1})),r=Array.from(document.getElementsByClassName(R.outline)),c=i.node();r.forEach((t=>{t!==c&&t.classList.remove(R.outline)})),null==c||c.classList.add(R.outline)}function _t(t,e){var n,a;const l=null==(n=this.parentNode)?void 0:n.parentNode,{foreign:o}=j;if(Yt&&o&&ft.value){l.classList.add(R.edited),P.emit("edit-flag",!1),o.attr("x",e.x-2).attr("y",e.y-rt.data.y-2).attr("data-id",e.id).attr("data-name",e.name).style("display","");const t=ft.value;t.textContent=e.name,t.focus(),null==(a=getSelection())||a.selectAllChildren(t)}}const $t=t=>{if(t.preventDefault(),!ht.value)return;const e=be(ht.value,t);Dt.value=e;const n=t.composedPath().find((t=>{var e;return null==(e=t.classList)?void 0:e.contains("node")}));if(n){const{classList:t}=n,e=t.contains(R.collapse);t.contains(R.selected)||_e(n),At.value.disabled=e,Vt.value.disabled=t.contains(R.root),zt.value.disabled=!e,Nt.value.disabled=e||t.contains("leaf")}St.value=!n,P.emit("showContextmenu",!0)},Mt=t=>{const{svg:e}=j;e&&(t?(ae(e),e.on("dblclick.zoom",null)):e.on(".zoom",null))},kt=t=>{ht.value&&(t?ht.value.addEventListener("contextmenu",$t):ht.value.removeEventListener("contextmenu",$t))};let Bt,Lt,Ct,Et;P.on("selection-svg",(t=>Bt=t)),P.on("selection-g",(t=>Lt=t)),P.on("selection-asstSvg",(t=>Ct=t)),P.on("selection-foreign",(t=>Et=t));const St=l(!0),Dt=l({left:0,top:0}),Nt=l({title:"折叠节点",name:"collapse",disabled:!0}),zt=l({title:"展开节点",name:"expand",disabled:!0}),Vt=l({title:"删除节点",name:"delete",disabled:!1}),At=l({title:"新建子节点",name:"add",disabled:!1}),jt=s((()=>[[At.value],[Vt.value],[{title:"全选",name:"selectall",disabled:!0}],[Nt.value,zt.value]])),Gt=s((()=>[[{title:"放大",name:"zoomin",disabled:ne.value.k>=qt[1]},{title:"缩小",name:"zoomout",disabled:ne.value.k<=qt[0]},{title:"缩放至合适大小",name:"zoomfit",disabled:!1}],[{title:"全选",name:"selectall",disabled:!0}]])),Pt=s((()=>St.value?Gt.value:jt.value)),Rt=i().source((t=>t.source)).target((t=>t.target)),Ut=r().curve(c),Ot=({source:t,target:e})=>Ut([t,e]);let Ht=!1,Kt=Rt;P.on("sharp-corner",(t=>{Ht=!!t,Kt=t?Ot:Rt}));let It=4;P.on("branch",(t=>It=t||It));let qt=[.1,8];P.on("scale-extent",(t=>qt=t||qt));let Yt=!1;P.on("edit-flag",(t=>Yt=!!t));let Tt=18,Ft=84,Wt=Math.min(Tt/2-1,10);P.on("gap",(t=>{t&&(Ft=t.xGap,Tt=t.yGap,Wt=Math.min(Tt/2-1,10),Wt=Math.min(Ft/2-1,Wt))}));const Xt=new ResizeObserver((t=>{const{foreign:e}=j;if(!e)return;const n=t[0],a=n.target,l=2*(parseInt(getComputedStyle(a).paddingLeft||"0",10)+parseInt(getComputedStyle(a.parentNode).borderTopWidth||"0",10));e.attr("width",n.contentRect.width+l).attr("height",n.contentRect.height+l)})),Jt={side:12,padding:2},Zt=Jt.side+2*Jt.padding,Qt=16,te=4,ee=2,ne=l(u),ae=d().on("zoom",(t=>{const{g:e}=j;e&&(ne.value=t.transform,e.attr("transform",t.transform.toString()))})).scaleExtent(qt),le=t=>{const e=["node"];return t&&e.push(`depth-${t.depth}`),e},oe=t=>`translate(${t.dx+t.px},${t.dy+t.py})`,se=t=>t.id,ie=t=>{const e=xe(t.name),n=t.height/e.length;return e.map((t=>({name:t,height:n})))},re=t=>{let e=0,n=0;const a=Math.max(Wt-3,0);let l=3;t.parent&&(e=t.parent.width,n=t.parent.height,0===t.parent.depth&&(Ht||(e/=2),n/=2,l=0));const o=[-t.dx+e-t.px,-t.dy+n+l-t.py],s=[0,t.height+3];return`${Kt({source:o,target:s})}L${t.width+a},${s[1]}`},ce=(t,e,n,a,l)=>{t?(ve(e,10),pe(n,10,6),me(a,10),l&&ge(l,10)):(ve(e,Wt),pe(n,Wt),me(a,Wt),l&&ge(l,Wt))},de=(t,e)=>{const n=t.attr("class",(t=>(t=>{const e=le(t);return t&&(0===t.depth&&e.push(R.root),t.collapse?e.push(R.collapse):t.children&&0!==t.children.length||e.push("leaf")),e})(t).join(" "))).attr("data-id",se);(e?n.transition(e):n).attr("transform",oe)},ue=t=>{t.attr("alignment-baseline","text-before-edge").text((t=>t.name||" ")).attr("x",0).attr("dy",((t,e)=>e?t.height:0))},he=(t,e)=>{t.attr("cx",e).attr("cy",0).attr("r",1)},pe=(t,e,n=4)=>{t.attr("x",-e).attr("y",-e).attr("rx",n).attr("ry",n).attr("width",(t=>t.width+2*e)).attr("height",(t=>t.height+2*e))},me=(t,e)=>{t.attr("class",R["expand-btn"]).attr("transform",(t=>((t,e)=>{const n=0===t.depth?t.height/2:t.height+3;return`translate(${t.width+e+Qt/2+4},${n})`})(t,e))).style("color",(t=>t.color))},ge=(t,e)=>{t.attr("class",(t=>(t=>{const e=[R["add-btn"]];return t.collapse&&e.push(R.hidden),e})(t).join(" "))).attr("transform",(t=>((t,e)=>{const n=0===t.depth?t.height/2:t.height+3;return`translate(${t.width+e+Zt/2+8},${n})`})(t,e)))},ve=(t,e)=>{t.attr("class",R.trigger).attr("x",-e).attr("y",-e).attr("width",(t=>t.width+2*e+8+Zt)).attr("height",(t=>t.height+2*e))},fe=(t,e)=>{const n=t.attr("stroke",(t=>t.color)).attr("stroke-width",It);(e?n.transition(e):n).attr("d",(t=>re(t)))},xe=t=>{const e=t.split("\n");return e.length>2&&""===e[e.length-1]&&e.pop(),e},ye=(t,e)=>h().duration(t).ease(e),be=(t,e)=>{const{pageX:n,pageY:a}=e,l=t.getBoundingClientRect();return{left:n-(l.left+window.pageXOffset),top:a-(l.top+window.pageYOffset)}};function we(){var t,e;return null==(e=null==(t=this.parentNode)?void 0:t.parentNode)?void 0:e.parentNode}function _e(t){const e=t instanceof SVGGElement?t:document.querySelector(`g[data-id='${se(t)}']`),n=document.getElementsByClassName(R.selected)[0];if(!e)throw new Error(`g[data-id='${se(t)}'] is null`);n?n!==e?(n.classList.remove(R.selected),e.classList.add(R.selected)):P.emit("edit-flag",!0):e.classList.add(R.selected)}const $e=t=>{const{asstSvg:e}=j;if(!e)throw new Error("asstSvg undefined");const n=xe(t),a=e.append("text");a.selectAll("tspan").data(n).enter().append("tspan").text((t=>t)).attr("x",0);const l=a.node().getBBox();return a.remove(),{width:Math.max(l.width,22),height:Math.max(l.height,22)*n.length}},Me=(t,e,n,a=0)=>{const l=ye(a,g);e.px=n[0],e.py=n[1],p(t).transition(l).attr("transform",oe),p(`g[data-id='${se(e)}'] > path`).transition(l).attr("d",(t=>re(t)))},ke=t=>{const e=t.append("tspan");return ue(e),e},Be=t=>(ue(t),t),Le=t=>{const e=t.append("g");return(t=>{const{side:e,padding:n}=Jt,a=-n-e/2,l=e+2*n;t.attr("x",a).attr("y",a).attr("rx",4).attr("ry",4).attr("width",l).attr("height",l)})(e.append("rect")),e.append("path").attr("d",((t,e)=>{const n=-e/2,a=-t/2,l=t/2,o=e/2;return`M${o},${l}H${l}V${o}H${a}V${l}H${n}V${a}H${a}V${n}H${l}V${a}H${o}V${l}Z`})(2,Jt.side)),e},Ce=t=>{const e=t.append("g");return e.append("rect").attr("x",-Qt/2).attr("y",-te/2).attr("width",Qt).attr("height",te).attr("rx",ee).attr("ry",ee).attr("stroke",(t=>t.color||"grey")).attr("fill",(t=>t.color||"grey")),he(e.append("circle"),-4),he(e.append("circle"),0),he(e.append("circle"),4),e};var Ee=v({name:"contextmenu",props:{position:{default:{top:0,left:0}},groups:Array},emits:["click-item"],setup(t,e){const n=l(!1),a=f();P.on("showContextmenu",(t=>n.value=!!t));const o=()=>n.value=!1;return{style:a,show:n,close:o,onClick:t=>{o(),e.emit("click-item",t)}}}});var Se={container:"Contextmenu_container_154ic",menu:"Contextmenu_menu_154ic",disabled:"Contextmenu_disabled_154ic"};(Ee.__cssModules={}).$style=Se,Ee.render=function(t,e,n,a,l,o){return x((M(),b("div",{class:t.style.container},[w("div",{onMousedown:e[1]||(e[1]=(...e)=>t.close&&t.close(...e))},null,32),w("div",{id:t.style.menu,style:{top:t.position.top+"px",left:t.position.left+"px"}},[(M(!0),b(_,null,$(t.groups,((e,n)=>(M(),b("ul",{key:n},[(M(!0),b(_,null,$(e,(e=>(M(),b("li",{class:e.disabled?t.style.disabled:"",key:e.name,onClick:n=>t.onClick(e.name)},k(e.title),11,["onClick"])))),128))])))),128))],12,["id"])],2)),[[y,t.show]])};var De=v({name:"Mindmap",components:{Contextmenu:Ee},props:{modelValue:{type:Array,required:!0},xGap:{type:Number,default:Ft},yGap:{type:Number,default:Tt},branch:{type:Number,default:It,validator:t=>t>=1&&t<=6},scaleExtent:{type:Object,default:qt},sharpCorner:Boolean,centerBtn:Boolean,fitBtn:Boolean,downloadBtn:Boolean,timetravel:Boolean,addNodeBtn:Boolean,edit:Boolean,drag:Boolean,keyboard:Boolean,contextmenu:Boolean,zoom:Boolean},setup(t,e){B((()=>P.emit("scale-extent",t.scaleExtent))),B((()=>P.emit("branch",t.branch))),B((()=>P.emit("sharp-corner",t.sharpCorner))),B((()=>P.emit("gap",{xGap:t.xGap,yGap:t.yGap})));const n=s((()=>t.edit&&t.addNodeBtn)),l=L().container(we).on("drag",wt).on("end",(function(t,e){var n;const a=null==(n=this.parentNode)?void 0:n.parentNode;pt.value&&pt.value.classList.remove(R.dragging);const l=document.getElementsByClassName(R.outline)[0];if(l){l.classList.remove(R.outline);const t=l.getAttribute("data-id");if(!t)throw new Error("outline data-id null");return e.px=0,e.py=0,void w(t,e.id)}const o=a.parentNode;let s=e,i=e;if(p(o).selectAll(`g.${le(e).join(".")}`).filter((t=>t!==e)).each((t=>{t.y>e.y&&t.y<e.y+e.py&&t.y>i.y&&(i=t),t.y<e.y&&t.y>e.y+e.py&&t.y<s.y&&(s=t)})),s!==e)return e.px=0,e.py=0,void _(e.id,s.id);if(i!==e)return e.px=0,e.py=0,void _(e.id,i.id,1);Me(a,e,[0,0],500)}));C((()=>{if(!(pt.value&&mt.value&&gt.value&&vt.value&&ft.value))return;P.emit("selection-svg",p(pt.value)),P.emit("selection-g",p(mt.value)),P.emit("selection-asstSvg",p(gt.value).attr("width",0).attr("height",0)),P.emit("selection-foreign",p(vt.value)),Xt.observe(ft.value),P.emit("mmdata",new it(a.cloneDeep(t.modelValue[0]),Ft,Tt,$e)),y();const{svg:e,foreign:n}=j;null==n||n.raise(),ft.value.addEventListener("blur",h),ft.value.addEventListener("mousedown",(t=>t.stopPropagation())),D(),N(),null==e||e.on("mousedown",(()=>{const t=document.getElementsByClassName(R.selected)[0];null==t||t.classList.remove(R.selected)})),Mt(t.zoom),kt(t.contextmenu)})),E((()=>[t.branch,n.value,t.sharpCorner]),(()=>c())),E((()=>[t.xGap,t.yGap]),(t=>{rt.setBoundingBox(t[0],t[1]),c()})),E((()=>[t.drag,t.edit]),(t=>{(t=>{const{g:e}=j;if(!e)return;const n=e.selectAll(`g.${R.text}`);t?n.on("mousedown",bt):n.on("mousedown",null)})(t[0]||t[1]),x(t[0]),(t=>{const{g:e}=j;if(!ft.value||!e)return;const n=e.selectAll(`g.${R.text}`);t?n.on("click",_t):n.on("click",null)})(t[1])})),E((()=>t.zoom),(t=>Mt(t))),E((()=>t.contextmenu),(t=>kt(t)));const o=t=>{const e=Le(t);return e.on("click",v),e},i=t=>{var e;const a=!(null==(e=t.data()[0])?void 0:e.depth),l=t.append("g");de(l),fe(l.append("path"));const s=l.append("g").attr("class",R.content),i=s.append("rect"),r=s.append("g").attr("class",R.text),u=r.append("rect"),h=r.append("text").selectAll("tspan").data(ie).enter().append("tspan");let p;ue(h),n.value&&(p=o(s));const m=Ce(s);return ce(a,i,u,m,p),d(l,a),l.each(((t,e)=>{t.children&&c(t.children,l.filter(((t,n)=>e===n)))})),s.raise(),l},r=t=>{var e;const a=!(null==(e=t.data()[0])?void 0:e.depth),l=ye(500,g);de(t,l),fe(t.select(":scope > path"),l);const s=t.select(`:scope > g.${R.content}`),i=s.select(":scope > rect"),r=s.select(`g.${R.text}`),d=r.select("rect");r.select("text").selectAll("tspan").data(ie).join(ke,Be,(t=>t.remove()));let u=s.select(`g.${R["add-btn"]}`),h=s.select(`g.${R["expand-btn"]}`);return n.value?u.node()||(u=o(s)):u.remove(),ce(a,i,d,h,u),t.each(((e,n)=>{e.children&&c(e.children,t.filter(((t,e)=>n===e)))})),s.raise(),t},c=(t=[rt.data],e=Lt)=>{e.selectAll(`g.${le(t[0]).join(".")}`).data(t,(t=>t.gKey)).join(i,r)},d=(e,a)=>{if(e.select(`:scope > g.${R.content} > g.${R["expand-btn"]}`).on("click",f),t.drag||t.edit){const n=e.select(`:scope > g.${R.content} > g.${R.text}`);n.on("mousedown",bt),t.drag&&!a&&l(n),t.edit&&n.on("click",_t)}n.value&&e.select(`:scope > g.${R.content}`).on("mouseenter",xt).on("mouseleave",yt)};const h=()=>{var t;if(null==(t=document.getElementsByClassName(R.edited)[0])||t.classList.remove(R.edited,R.selected),vt.value&&ft.value){vt.value.style.display="none";const t=vt.value.getAttribute("data-id"),e=vt.value.getAttribute("data-name"),n=ft.value.textContent;t&&null!==n&&n!==e&&b(t,n)}},v=(t,e)=>{const n=$(e.id,""),{g:a}=j;if(!a||!n)return;const l=a.selectAll(`g[data-id='${se(n)}'] g.${R.text}`).node();l&&(P.emit("edit-flag",!0),_t.call(l,t,n))},f=(t,e)=>{k(e.id)},x=t=>{const{g:e}=j;if(!e)return;const n=e.selectAll(`g.node:not(.${R.root}) > g > g.${R.text}`);t?l(n):n.on(".drag",null)},y=(t=!0)=>{t&&ct.snap(rt.data),e.emit("update:modelValue",a.cloneDeep([rt.data.rawData])),dt.value=ct.hasPrev,ut.value=ct.hasNext,c()},b=(t,e)=>{rt.rename(t,e),y()},w=(t,e)=>{rt.moveChild(t,e),y()},_=(t,e,n=0)=>{rt.moveSibling(t,e,n),y()},$=(t,e)=>{const n=rt.add(t,e);return y(),n},M=t=>{rt.delete(t),y()},k=t=>{rt.expand(t),y()},S=t=>{rt.collapse(t),y()},D=()=>{const{svg:t}=j;if(!t)return;const e=rt.data;ae.translateTo(t,0+e.width/2,0+e.height/2)},N=()=>{const{svg:t}=j;if(!t||!mt.value||!pt.value)return;const e=mt.value.getBBox(),n=pt.value.getBoundingClientRect(),a=Math.min(n.width/e.width,n.height/e.height),l=n.width/2,o=n.height/2,s=e.width*a/2,i=e.height*a/2,r=u.translate(-e.x*a+l-s,-e.y*a+o-i).scale(a);ae.transform(t,r)},z=t=>{const{svg:e}=j;e&&ae.scaleBy(e,t?1.1:.9)};return{wrapperEle:ht,svgEle:pt,gEle:mt,style:R,asstSvgEle:gt,foreignEle:vt,foreignDivEle:ft,centerView:D,fitView:N,download:()=>{var t,e;ht.value&&(t=ht.value,e=rt.data.name,m(t).then((t=>{const n=t.toDataURL(),a=open();a&&(a.document.write(`<img src='${n}'>`),a.document.title=e,a.document.close())})))},menu:Pt,contextmenuPos:Dt,onClickMenu:t=>{if("zoomfit"===t)N();else if("zoomin"===t)z(!0);else if("zoomout"===t)z(!1);else if("add"===t){const t=p(`.${R.selected}`).data()[0];v(new MouseEvent("click"),t)}else if("delete"===t){const t=p(`.${R.selected}`).data()[0];M(t.id)}else if("collapse"===t){const t=p(`.${R.selected}`).data()[0];S(t.id)}else if("expand"===t){const t=p(`.${R.selected}`).data()[0];k(t.id)}},next:()=>{const t=ct.next();t&&(rt.data=t,y(!1))},prev:()=>{const t=ct.prev();t&&(rt.data=t,y(!1))},hasPrev:dt,hasNext:ut}}});const Ne={ref:"gEle"},ze={ref:"foreignEle",style:{display:"none"}},Ve={ref:"foreignDivEle",contenteditable:""},Ae={ref:"asstSvgEle"};De.render=function(t,e,n,a,l,o){const s=S("contextmenu");return M(),b("div",{class:t.style.container},[w("div",{id:t.style["svg-wrapper"],ref:"wrapperEle"},[(M(),b("svg",{class:t.style.svg,ref:"svgEle"},[w("g",Ne,[(M(),b("foreignObject",ze,[w("div",Ve,null,512)],512))],512)],2))],8,["id"]),(M(),b("svg",Ae,null,512)),w("div",{class:[t.style["button-list"],t.style["right-bottom"]]},[t.centerBtn?(M(),b("button",{key:0,onClick:e[1]||(e[1]=e=>t.centerView())},[w("i",{class:t.style.gps},null,2)])):D("",!0),t.fitBtn?(M(),b("button",{key:1,onClick:e[2]||(e[2]=e=>t.fitView())},[w("i",{class:t.style.fit},null,2)])):D("",!0),t.downloadBtn?(M(),b("button",{key:2,onClick:e[3]||(e[3]=e=>t.download())},[w("i",{class:t.style.download},null,2)])):D("",!0)],2),t.timetravel?(M(),b("div",{key:0,class:[t.style["button-list"],t.style["right-top"]]},[w("button",{onClick:e[4]||(e[4]=(...e)=>t.prev&&t.prev(...e)),class:{[t.style.disabled]:!t.hasPrev}},[w("i",{class:t.style.prev},null,2)],2),w("button",{onClick:e[5]||(e[5]=(...e)=>t.next&&t.next(...e)),class:{[t.style.disabled]:!t.hasNext}},[w("i",{class:t.style.next},null,2)],2)],2)):D("",!0),t.contextmenu?(M(),b(s,{key:1,position:t.contextmenuPos,groups:t.menu,onClickItem:t.onClickMenu},null,8,["position","groups","onClickItem"])):D("",!0)],2)};var je=v({name:"App",components:{Mindmap:De},setup(){const t=N({"center-btn":{value:!0},"fit-btn":{value:!0},timetravel:{value:!0},"download-btn":{value:!0},"add-node-btn":{value:!0},keyboard:{value:!1,disabled:!0},zoom:{value:!0},drag:{value:!0},edit:{value:!0},contextmenu:{value:!0},"sharp-corner":{value:!1},vertical:{value:!1,disabled:!0}}),e=N({branch:{value:It,min:1,max:6},"x-gap":{value:Ft,min:0,max:100},"y-gap":{value:Tt,min:0,max:100}});return{data:l(G),checkboxList:t,rangeList:e}}});const Ge={class:"container"},Pe=w("div",{class:"left-top"},[w("a",{href:"https://github.com/hellowuxin/vue3-mindmap",target:"_blank"},"GitHub")],-1),Re=w("div",{class:"right-top"},[w("span",null,"Props")],-1),Ue={class:"right-bottom"};je.render=function(t,e,n,a,l,o){const s=S("mindmap");return M(),b("div",Ge,[Pe,Re,w(s,{class:"left-bottom",modelValue:t.data,"onUpdate:modelValue":e[1]||(e[1]=e=>t.data=e),branch:t.rangeList.branch.value,"x-gap":t.rangeList["x-gap"].value,"y-gap":t.rangeList["y-gap"].value,zoom:t.checkboxList.zoom.value,"fit-btn":t.checkboxList["fit-btn"].value,"center-btn":t.checkboxList["center-btn"].value,"download-btn":t.checkboxList["download-btn"].value,drag:t.checkboxList.drag.value,edit:t.checkboxList.edit.value,"add-node-btn":t.checkboxList["add-node-btn"].value,"sharp-corner":t.checkboxList["sharp-corner"].value,contextmenu:t.checkboxList.contextmenu.value,timetravel:t.checkboxList.timetravel.value},null,8,["modelValue","branch","x-gap","y-gap","zoom","fit-btn","center-btn","download-btn","drag","edit","add-node-btn","sharp-corner","contextmenu","timetravel"]),w("div",Ue,[(M(!0),b(_,null,$(t.checkboxList,((t,e)=>(M(),b("div",{key:e},[x(w("input",{type:"checkbox",name:e.toString(),"onUpdate:modelValue":e=>t.value=e,disabled:t.disabled},null,8,["name","onUpdate:modelValue","disabled"]),[[z,t.value]]),w("label",{for:e.toString()},k(e),9,["for"])])))),128)),(M(!0),b(_,null,$(t.rangeList,((t,e)=>(M(),b("div",{key:e},[x(w("input",{type:"range",name:e,"onUpdate:modelValue":e=>t.value=e,min:t.min,max:t.max},null,8,["name","onUpdate:modelValue","min","max"]),[[V,t.value,void 0,{number:!0}]]),w("label",{for:e},k(e)+"（"+k(t.value)+"）",9,["for"])])))),128))])])},A(je).mount("#app");
