import{m as e,o as t,P as n,l as a,t as l,h as o,r as i,c as s,a as r,b as c,s as d,i as u,d as h,u as p,w as m,v as g,e as v,f as x,F as f,g as y,j as b,k as w,n as _,z as $,p as M,q as k,x as B,y as L,A as C,B as E,C as N,D,E as S,G as V,H as z,I as A}from"./vendor.37e86f33.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(n){const a=new URL(e,location),l=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((n,o)=>{const i=new URL(e,a);if(self[t].moduleMap[i])return n(self[t].moduleMap[i]);const s=new Blob([`import * as m from '${i}';`,`${t}.moduleMap['${i}']=m;`],{type:"text/javascript"}),r=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(s),onerror(){o(new Error(`Failed to import: ${e}`)),l(r)},onload(){n(self[t].moduleMap[i]),l(r)}});document.head.appendChild(r)})),self[t].moduleMap={}}}("/vue3-mindmap/assets/");var j=[{name:"如何学习D3",children:[{name:"预备知识",children:[{name:"HTML & CSS"},{name:"JavaScript"},{name:"DOM"},{name:"SVG"},{name:"test\ntest"}]},{name:"安装",collapse:!0,children:[{name:"折叠节点"}]},{name:"入门",children:[{name:"选择集"},{name:"test"},{name:"绑定数据"},{name:"添加删除元素"},{name:"简单图形",children:[{name:"柱形图"},{name:"折线图"},{name:"散点图"}]},{name:"比例尺"},{name:"生成器"},{name:"过渡"}],left:!0},{name:"进阶",left:!0},{name:"一级节点",children:[{name:"子节点1"},{name:"子节点2"},{name:"子节点3"}]}]}];const G=e();var P={container:"Mindmap_container_7uix5","svg-wrapper":"Mindmap_svg-wrapper_7uix5",svg:"Mindmap_svg_7uix5",trigger:"Mindmap_trigger_7uix5",dragging:"Mindmap_dragging_7uix5","add-btn":"Mindmap_add-btn_7uix5",hidden:"Mindmap_hidden_7uix5","expand-btn":"Mindmap_expand-btn_7uix5",text:"Mindmap_text_7uix5",selected:"Mindmap_selected_7uix5",content:"Mindmap_content_7uix5",root:"Mindmap_root_7uix5",edited:"Mindmap_edited_7uix5",outline:"Mindmap_outline_7uix5",collapse:"Mindmap_collapse_7uix5","button-list":"Mindmap_button-list_7uix5","right-bottom":"Mindmap_right-bottom_7uix5","right-top":"Mindmap_right-top_7uix5",disabled:"Mindmap_disabled_7uix5",gps:"Mindmap_gps_7uix5",fit:"Mindmap_fit_7uix5",download:"Mindmap_download_7uix5",prev:"Mindmap_prev_7uix5",next:"Mindmap_next_7uix5",close:"Mindmap_close_7uix5"};class R{constructor(e,t,n,a){this.w=e,this.h=t,this.y=n,this.c=a,this.cs=a.length,this.x=0,this.prelim=0,this.mod=0,this.shift=0,this.change=0,this.tl=null,this.tr=null,this.el=null,this.er=null,this.msel=0,this.mser=0}}function U(e){0===e.cs?(e.el=e,e.er=e,e.msel=e.mser=0):(e.el=e.c[0].el,e.msel=e.c[0].msel,e.er=e.c[e.cs-1].er,e.mser=e.c[e.cs-1].mser)}function O(e){return e.y+e.h}class H{constructor(e,t,n){this.lowY=e,this.index=t,this.next=n}}function K(e,t,n){for(;null!==n&&e>=n.lowY;)n=n.next;return new H(e,t,n)}function I(e,t,n,a){e.c[t].mod+=a,e.c[t].msel+=a,e.c[t].mser+=a,function(e,t,n,a){if(n!==t-1){const l=t-n;e.c[n+1].shift+=a/l,e.c[t].shift-=a/l,e.c[t].change-=a-a/l}}(e,t,n,a)}function q(e){return 0===e.cs?e.tl:e.c[0]}function Y(e){return 0===e.cs?e.tr:e.c[e.cs-1]}function F(e,t,n){let a=e.c[t-1],l=a.mod,o=e.c[t],i=o.mod;for(;null!==a&&null!==o;){O(a)>n.lowY&&(n=n.next);const s=l+a.prelim+a.w-(i+o.prelim);s>0&&(i+=s,I(e,t,n.index,s));const r=O(a),c=O(o);r<=c&&(a=Y(a),null!==a&&(l+=a.mod)),r>=c&&(o=q(o),null!==o&&(i+=o.mod))}null===a&&null!==o?function(e,t,n,a){const l=e.c[0].el;l.tl=n;const o=a-n.mod-e.c[0].msel;l.mod+=o,l.prelim-=o,e.c[0].el=e.c[t].el,e.c[0].msel=e.c[t].msel}(e,t,o,i):null!==a&&null===o&&function(e,t,n,a){const l=e.c[t].er;l.tr=n;const o=a-n.mod-e.c[t].mser;l.mod+=o,l.prelim-=o,e.c[t].er=e.c[t-1].er,e.c[t].mser=e.c[t-1].mser}(e,t,a,l)}function J(e){if(0===e.cs)return void U(e);J(e.c[0]);let t=K(O(e.c[0].el),0,null);for(let n=1;n<e.cs;n++){J(e.c[n]);const a=O(e.c[n].er);F(e,n,t),t=K(a,n,t)}!function(e){e.prelim=(e.c[0].prelim+e.c[0].mod+e.c[e.cs-1].mod+e.c[e.cs-1].prelim+e.c[e.cs-1].w)/2-e.w/2}(e),U(e)}function T(e,t){t+=e.mod,e.x=e.prelim+t,function(e){let t=0,n=0;for(let a=0;a<e.cs;a++)t+=e.c[a].shift,n+=t+e.c[a].change,e.c[a].mod+=n}(e);for(let n=0;n<e.cs;n++)T(e.c[n],t)}function W(e){J(e),T(e,0)}class X{constructor(e,t){this.gap=e,this.bottomPadding=t}addBoundingBox(e,t){return{width:e+this.gap,height:t+this.bottomPadding}}removeBoundingBox(e,t){return{x:e+this.gap/2,y:t}}}class Z{constructor(e){this.bb=e}layout(e){const t=this.convert(e);W(t);const{boundingBox:n,result:a}=this.assignLayout(t,e);return{result:a,boundingBox:n}}convert(e,t=0){const{width:n,height:a}=this.bb.addBoundingBox(e.width,e.height),l=[];if(e.children&&e.children.length)for(let o=0;o<e.children.length;o++)l[o]=this.convert(e.children[o],t+a);return new R(n,a,t,l)}assignCoordinates(e,t){const{x:n,y:a}=this.bb.removeBoundingBox(e.x,e.y);t.x=n,t.y=a;for(let l=0;l<e.c.length;l++)this.assignCoordinates(e.c[l],t.children[l])}getSize(e,t){const{x:n,y:a,width:l,height:o}=e;if(t||(t={left:n,right:n+l,top:a,bottom:a+o}),t.left=Math.min(t.left,n),t.right=Math.max(t.right,n+l),t.top=Math.min(t.top,a),t.bottom=Math.max(t.bottom,a+o),e.children)for(const i of e.children)this.getSize(i,t);return t}assignLayout(e,t,n){const{x:a,y:l}=this.bb.removeBoundingBox(e.x,e.y);t.x=a,t.y=l;const{width:o,height:i}=t;n||(n={left:a,right:a+o,top:l,bottom:l+i}),n.left=Math.min(n.left,a),n.right=Math.max(n.right,a+o),n.top=Math.min(n.top,l),n.bottom=Math.max(n.bottom,l+i);for(let s=0;s<e.c.length;s++)this.assignLayout(e.c[s],t.children[s],n);return{result:t,boundingBox:n}}}function Q(e,t){const n=t(e.name),a={rawData:e,width:n.height,height:n.width,x:0,y:0,children:[],_children:[]},{children:l,collapse:o}=e;if(l){const e=[];o?a._children=e:a.children=e,l.forEach((n=>{e.push(Q(n,t))}))}return a}const ee=e=>{[e.width,e.height]=[e.height,e.width]},te=e=>{[e.x,e.y]=[e.y,e.x]},ne=e=>{e.parent?(e.dx=e.x-e.parent.x,e.dy=e.y-e.parent.y):(e.dx=0,e.dy=0)},ae=(e,t)=>{e.id=t},le=(e,t,n="0")=>{var a;t.forEach((t=>{t(e,n)}));const{children:l}=e;if(l)for(let o=0;o<l.length;){const i=l[o];"del"===i.id?(l.splice(o,1),null==(a=e.rawData.children)||a.splice(o,1)):(le(i,t,`${n}-${o}`),o+=1)}},oe=(e,t)=>{const n=new X(t,e);return new Z(n)};class ie{constructor(e,a,l,o,i=t(n)){this.colorNumber=0,this.gKey=0,this.colorScale=i,this.getSize=o;const s=Q(e,o);this.layout=oe(a,l),this.layout.layout(s),this.data=this.init(s)}init(e,t="0",n=null,a){const l=e.y,o=e.x;let i="",s=!1,r=l,c=o;n&&(s=n.left,r=n.x,c=n.y,i=a||this.colorScale(`${this.colorNumber+=1}`));const d={x:l,y:o,width:e.height,height:e.width,id:t,gKey:this.gKey+=1,depth:Math.floor(t.length/2),name:e.rawData.name,px:0,py:0,rawData:e.rawData,parent:n,color:i,left:s,collapse:!!e.rawData.collapse,dx:l-r,dy:o-c,children:[],_children:[]};return e.children&&!d.collapse&&e.children.forEach(((e,n)=>{d.children.push(this.init(e,`${t}-${n}`,d,i))})),e._children&&d.collapse&&e._children.forEach(((e,n)=>{d._children.push(this.init(e,`${t}-${n}`,d,i))})),d}renewColor(e){e.parent&&(e.parent.color?e.color=e.parent.color:e.color||(e.color=this.colorScale(`${this.colorNumber+=1}`)))}setBoundingBox(e,t){this.layout=oe(e,t),this.renew()}find(e){const t=e.split("-").map((e=>~~e));let n=this.data;for(let a=1;a<t.length;a++){if(!n||!n.children)return null;n=n.children[t[a]]||null}return n}rename(e,t){if(e.length>0){const n=this.find(e);if(n&&n.name!==t){n.name=t,n.rawData.name=t;const e=this.getSize(n.name);n.width=e.width,n.height=e.height,this.renew()}return n}return null}moveChild(e,t){var n,a;if(e===t)return null;const l=this.find(e),o=this.find(t),i=t.split("-").pop();if(i&&l&&o){const e=o.parent;null==(n=null==e?void 0:e.children)||n.splice(~~i,1),null==(a=null==e?void 0:e.rawData.children)||a.splice(~~i,1),o.parent=l,o.gKey=this.gKey+=1,o.depth=o.parent.depth+1,1===o.depth&&(o.color=this.colorScale(`${this.colorNumber+=1}`)),l.children?l.children.push(o):l.children=[o],l.rawData.children?l.rawData.children.push(o.rawData):l.rawData.children=[o.rawData],this.renew(ae,this.renewColor)}return o}moveSibling(e,t,n=0){const a=e.split("-"),l=t.split("-");let o=a.pop(),i=l.pop();if(e===t||a.length!==l.length||!o||!i)return null;const s=this.find(e);if(s&&s.parent){o=parseInt(o,10),i=parseInt(i,10),o<i&&(i-=1);const{children:e}=s.parent,{children:t}=s.parent.rawData;if(e&&t)return e.splice(o,1),e.splice(i+n,0,s),t.splice(o,1),t.splice(i+n,0,s.rawData),this.renew(ae),s}return null}add(e,t){const n=this.find(e);if(n){n.children||(n.children=[]),n.rawData.children||(n.rawData.children=[]);const e=this.getSize(t),a={name:t},l=n.color?n.color:this.colorScale(`${this.colorNumber+=1}`),o={id:`${n.id}-${n.children.length}`,name:t,rawData:a,parent:n,left:n.left,collapse:!1,color:l,gKey:this.gKey+=1,width:e.width,height:e.height,depth:n.depth+1,x:0,y:0,dx:0,dy:0,px:0,py:0,children:[],_children:[]};return n.children.push(o),n.rawData.children.push(a),this.renew(),o}return null}expand(e){return this.eoc(e,!1)}collapse(e){return this.eoc(e,!0)}eoc(e,t){const n=this.find(e);return n&&(n.collapse=t,n.rawData.collapse=t,[n._children,n.children]=[n.children,n._children],this.renew()),n}renew(...e){le(this.data,[ee]),this.layout.layout(this.data);const t=[ee,te,ne];le(this.data,t.concat(e))}delete(e){const t=e.split("-");if(!(t.length>=2))throw new Error("暂不支持删除根节点");{const e=t.pop(),n=this.find(t.join("-"));e&&n&&n.children&&(n.children[~~e].id="del"),this.renew(ae)}}}var se=new class{constructor(e=20){this.length=e,this.snapshots=[],this.cursor=-1}get hasPrev(){return this.cursor>0}get hasNext(){return this.snapshots.length>this.cursor+1}snap(e){const t=a.cloneDeep(e);for(;this.cursor<this.snapshots.length-1;)this.snapshots.pop();this.snapshots.push(t),this.snapshots.length>this.length&&this.snapshots.shift(),this.cursor=this.snapshots.length-1}prev(){return this.hasPrev?(this.cursor-=1,a.cloneDeep(this.snapshots[this.cursor])):null}next(){return this.hasNext?(this.cursor+=1,a.cloneDeep(this.snapshots[this.cursor])):null}};const re=e=>{const t=e.split("\n");return t.length>2&&""===t[t.length-1]&&t.pop(),t},ce=(e,t)=>l().duration(e).ease(t);function de(){var e,t;return null==(t=null==(e=this.parentNode)?void 0:e.parentNode)?void 0:t.parentNode}const ue=i({left:0,top:0}),he=i({title:"折叠节点",name:"collapse",disabled:!0}),pe=i({title:"展开节点",name:"expand",disabled:!0}),me=i({title:"删除节点",name:"delete",disabled:!1}),ge=i({title:"新建子节点",name:"add",disabled:!1}),ve=s((()=>[[ge.value],[me.value],[{title:"全选",name:"selectall",disabled:!0}],[he.value,pe.value]])),xe=s((()=>[[{title:"放大",name:"zoomin",disabled:be.value.k>=Ve[1]},{title:"缩小",name:"zoomout",disabled:be.value.k<=Ve[0]},{title:"缩放至合适大小",name:"zoomfit",disabled:!1}],[{title:"全选",name:"selectall",disabled:!0}]])),fe=r().source((e=>e.source)).target((e=>e.target)),ye=c().curve(d),be=i(u);let we=fe;const _e=({source:e,target:t})=>ye([e,t]),$e={side:12,padding:2},Me=$e.side+2*$e.padding,ke=16,Be=4,Le=2;let Ce=4,Ee=18,Ne=84,De=Math.min(Ee/2-1,10),Se=!1,Ve=[.1,8];G.on("branch",(e=>Ce=e||Ce)),G.on("scale-extent",(e=>Ve=e||Ve)),G.on("sharp-corner",(e=>{Se=!!e,we=e?_e:fe})),G.on("gap",(e=>{e&&(Ne=e.xGap,Ee=e.yGap,De=Math.min(Ee/2-1,10),De=Math.min(Ne/2-1,De))}));const ze=e=>{const t=["node"];return e&&t.push(`depth-${e.depth}`),t},Ae=e=>`translate(${e.dx+e.px},${e.dy+e.py})`,je=e=>e.id,Ge=e=>{const t=re(e.name),n=e.height/t.length;return t.map((e=>({name:e,height:n})))},Pe=e=>{let t=0,n=0;const a=Math.max(De-3,0);let l=3;e.parent&&(t=e.parent.width,n=e.parent.height,0===e.parent.depth&&(Se||(t/=2),n/=2,l=0));const o=[-e.dx+t-e.px,-e.dy+n+l-e.py],i=[0,e.height+3];return`${we({source:o,target:i})}L${e.width+a},${i[1]}`},Re=(e,t,n,a,l)=>{e?(Ye(t,10),Ke(n,10,6),Ie(a,10),l&&qe(l,10)):(Ye(t,De),Ke(n,De),Ie(a,De),l&&qe(l,De))},Ue=(e,t)=>{const n=e.attr("class",(e=>(e=>{const t=ze(e);return e&&(0===e.depth&&t.push(P.root),e.collapse?t.push(P.collapse):e.children&&0!==e.children.length||t.push("leaf")),t})(e).join(" "))).attr("data-id",je);(t?n.transition(t):n).attr("transform",Ae)},Oe=e=>{e.attr("alignment-baseline","text-before-edge").text((e=>e.name||" ")).attr("x",0).attr("dy",((e,t)=>t?e.height:0))},He=(e,t)=>{e.attr("cx",t).attr("cy",0).attr("r",1)},Ke=(e,t,n=4)=>{e.attr("x",-t).attr("y",-t).attr("rx",n).attr("ry",n).attr("width",(e=>e.width+2*t)).attr("height",(e=>e.height+2*t))},Ie=(e,t)=>{e.attr("class",P["expand-btn"]).attr("transform",(e=>((e,t)=>{const n=0===e.depth?e.height/2:e.height+3;return`translate(${e.width+t+ke/2+4},${n})`})(e,t))).style("color",(e=>e.color))},qe=(e,t)=>{e.attr("class",(e=>(e=>{const t=[P["add-btn"]];return e.collapse&&t.push(P.hidden),t})(e).join(" "))).attr("transform",(e=>((e,t)=>{const n=0===e.depth?e.height/2:e.height+3;return`translate(${e.width+t+Me/2+8},${n})`})(e,t)))},Ye=(e,t)=>{e.attr("class",P.trigger).attr("x",-t).attr("y",-t).attr("width",(e=>e.width+2*t+8+Me)).attr("height",(e=>e.height+2*t))},Fe=(e,t)=>{const n=e.attr("stroke",(e=>e.color)).attr("stroke-width",Ce);(t?n.transition(t):n).attr("d",(e=>Pe(e)))},Je=e=>{const t=e.append("tspan");return Oe(t),t},Te=e=>(Oe(e),e),We=e=>{const t=e.append("g");return(e=>{const{side:t,padding:n}=$e,a=-n-t/2,l=t+2*n;e.attr("x",a).attr("y",a).attr("rx",4).attr("ry",4).attr("width",l).attr("height",l)})(t.append("rect")),t.append("path").attr("d",((e,t)=>{const n=-t/2,a=-e/2,l=e/2,o=t/2;return`M${o},${l}H${l}V${o}H${a}V${l}H${n}V${a}H${a}V${n}H${l}V${a}H${o}V${l}Z`})(2,$e.side)),t},Xe=e=>{const t=e.append("g");return t.append("rect").attr("x",-ke/2).attr("y",-Be/2).attr("width",ke).attr("height",Be).attr("rx",Le).attr("ry",Le).attr("stroke",(e=>e.color||"grey")).attr("fill",(e=>e.color||"grey")),He(t.append("circle"),-4),He(t.append("circle"),0),He(t.append("circle"),4),t};function Ze(){const e=this.querySelector(`g.${P["add-btn"]}`);e&&(e.style.opacity="1")}function Qe(){const e=this.querySelector(`g.${P["add-btn"]}`);e&&(e.style.opacity="0")}var et=h({name:"contextmenu",props:{position:{default:{top:0,left:0}},groups:Array},emits:["click-item"],setup(e,t){const n=i(!1),a=p();G.on("showContextmenu",(e=>n.value=e));const l=()=>n.value=!1;return{style:a,show:n,close:l,onClick:e=>{l(),t.emit("click-item",e)}}}});var tt={container:"Contextmenu_container_154ic",menu:"Contextmenu_menu_154ic",disabled:"Contextmenu_disabled_154ic"};(et.__cssModules={}).$style=tt,et.render=function(e,t,n,a,l,o){return m((b(),v("div",{class:e.style.container},[x("div",{onMousedown:t[1]||(t[1]=(...t)=>e.close&&e.close(...t))},null,32),x("div",{id:e.style.menu,style:{top:e.position.top+"px",left:e.position.left+"px"}},[(b(!0),v(f,null,y(e.groups,((t,n)=>(b(),v("ul",{key:n},[(b(!0),v(f,null,y(t,(t=>(b(),v("li",{class:t.disabled?e.style.disabled:"",key:t.name,onClick:n=>e.onClick(t.name)},w(t.title),11,["onClick"])))),128))])))),128))],12,["id"])],2)),[[g,e.show]])};var nt=h({name:"Mindmap",components:{Contextmenu:et},props:{modelValue:{type:Array,required:!0},xGap:{type:Number,default:Ne},yGap:{type:Number,default:Ee},branch:{type:Number,default:Ce,validator:e=>e>=1&&e<=6},scaleExtent:{type:Object,default:Ve},sharpCorner:Boolean,centerBtn:Boolean,fitBtn:Boolean,downloadBtn:Boolean,timetravel:Boolean,addNodeBtn:Boolean,edit:Boolean,drag:Boolean,keyboard:Boolean,contextmenu:Boolean,zoom:Boolean},setup(e,t){_((()=>G.emit("scale-extent",e.scaleExtent))),_((()=>G.emit("branch",e.branch))),_((()=>G.emit("sharp-corner",e.sharpCorner))),_((()=>G.emit("gap",{xGap:e.xGap,yGap:e.yGap})));const n=i(!1),l=i(!1),s=i(),r=i(),c=i(),d=i(),h=i(),p=i(),m=i(),g=i(),v=i(),x=i(),f=$().on("zoom",(function(e){if(!g.value)return;be.value=e.transform,g.value.attr("transform",e.transform.toString())})).scaleExtent(Ve),y=M().container(de).on("drag",(function(e,t){var n;const a=null==(n=this.parentNode)?void 0:n.parentNode;r.value&&r.value.classList.add(P.dragging);if(!g.value)return;U(a,t,[e.x-t.x,e.y-t.y]);const l=C(e,c.value);l[1]+=w.data.y;const o=g.value.selectAll("g.node").filter((e=>{if(e!==t&&e!==t.parent&&!e.id.startsWith(t.id)){const t={x0:e.x-De,x1:e.x+e.width+De,y0:e.y-De,y1:e.y+e.height+De};return l[0]>t.x0&&l[1]>t.y0&&l[0]<t.x1&&l[1]<t.y1}return!1})),i=Array.from(document.getElementsByClassName(P.outline)),s=o.node();i.forEach((e=>{e!==s&&e.classList.remove(P.outline)})),null==s||s.classList.add(P.outline)})).on("end",(function(e,t){var n;const a=null==(n=this.parentNode)?void 0:n.parentNode;r.value&&r.value.classList.remove(P.dragging);const l=document.getElementsByClassName(P.outline)[0];if(l){l.classList.remove(P.outline);const e=l.getAttribute("data-id");if(!e)throw new Error("outline data-id null");return t.px=0,t.py=0,void te(e,t.id)}const o=a.parentNode;let i=t,s=t;if(B(o).selectAll(`g.${ze(t).join(".")}`).filter((e=>e!==t)).each((e=>{e.y>t.y&&e.y<t.y+t.py&&e.y>s.y&&(s=e),e.y<t.y&&e.y>t.y+t.py&&e.y<i.y&&(i=e)})),i!==t)return t.px=0,t.py=0,void ne(t.id,i.id);if(s!==t)return t.px=0,t.py=0,void ne(t.id,s.id,1);U(a,t,[0,0],500)})),b=new ResizeObserver((e=>{if(!x.value)return;const t=e[0],n=t.target,a=2*(parseInt(getComputedStyle(n).paddingLeft||"0",10)+parseInt(getComputedStyle(n.parentNode).borderTopWidth||"0",10));x.value.attr("width",t.contentRect.width+a).attr("height",t.contentRect.height+a)}));let w,N=!1;const D=i(!0);k((()=>{r.value&&c.value&&d.value&&h.value&&p.value&&(m.value=B(r.value),g.value=B(c.value),v.value=B(d.value).attr("width",0).attr("height",0),x.value=B(h.value),b.observe(p.value),w=new ie(JSON.parse(JSON.stringify(e.modelValue[0])),Ne,Ee,j),Q(),x.value.raise(),p.value.addEventListener("blur",K),p.value.addEventListener("mousedown",(e=>e.stopPropagation())),ye(),we(),m.value.on("mousedown",(()=>{const e=document.getElementsByClassName(P.selected)[0];null==e||e.classList.remove(P.selected)})),J(e.zoom),Z(e.contextmenu))})),L((()=>[e.branch,e.addNodeBtn,e.sharpCorner]),(()=>A())),L((()=>[e.xGap,e.yGap]),(e=>{w.setBoundingBox(e[0],e[1]),A()})),L((()=>[e.drag,e.edit]),(e=>{X(e[0]||e[1]),W(e[0]),T(e[1])})),L((()=>e.zoom),(e=>J(e))),L((()=>e.contextmenu),(e=>Z(e)));const S=e=>{const t=We(e);return t.on("click",q),t},V=t=>{var n;const a=!(null==(n=t.data()[0])?void 0:n.depth),l=t.append("g");Ue(l),Fe(l.append("path"));const o=l.append("g").attr("class",P.content),i=o.append("rect"),s=o.append("g").attr("class",P.text),r=s.append("rect"),c=s.append("text").selectAll("tspan").data(Ge).enter().append("tspan");let d;Oe(c),e.addNodeBtn&&(d=S(o));const u=Xe(o);return Re(a,i,r,u,d),O(l,a),l.each(((e,t)=>{e.children&&A(e.children,l.filter(((e,n)=>t===n)))})),o.raise(),l},z=t=>{var n;const a=!(null==(n=t.data()[0])?void 0:n.depth),l=ce(500,E);Ue(t,l),Fe(t.select(":scope > path"),l);const o=t.select(`:scope > g.${P.content}`),i=o.select(":scope > rect"),s=o.select(`g.${P.text}`),r=s.select("rect");s.select("text").selectAll("tspan").data(Ge).join(Je,Te,(e=>e.remove()));let c=o.select(`g.${P["add-btn"]}`),d=o.select(`g.${P["expand-btn"]}`);return e.addNodeBtn?c.node()||(c=S(o)):c.remove(),Re(a,i,r,d,c),t.each(((e,n)=>{e.children&&A(e.children,t.filter(((e,t)=>n===t)))})),o.raise(),t},A=(e=[w.data],t=g.value)=>{t.selectAll(`g.${ze(e[0]).join(".")}`).data(e,(e=>e.gKey)).join(V,z)},j=e=>{if(!v.value)throw new Error("asstSvg undefined");const t=re(e),n=v.value.append("text");n.selectAll("tspan").data(t).enter().append("tspan").text((e=>e)).attr("x",0);const a=n.node().getBBox();return n.remove(),{width:Math.max(a.width,22),height:Math.max(a.height,22)*t.length}};function R(e){const t=e instanceof SVGGElement?e:document.querySelector(`g[data-id='${je(e)}']`),n=document.getElementsByClassName(P.selected)[0];if(!t)throw new Error(`g[data-id='${je(e)}'] is null`);n?n!==t?(n.classList.remove(P.selected),t.classList.add(P.selected)):N=!0:t.classList.add(P.selected)}const U=(e,t,n,a=0)=>{const l=ce(a,E);t.px=n[0],t.py=n[1],B(e).transition(l).attr("transform",Ae),B(`g[data-id='${je(t)}'] > path`).transition(l).attr("d",(e=>Pe(e)))},O=(t,n)=>{if(t.select(`:scope > g.${P.content} > g.${P["expand-btn"]}`).on("click",F),e.drag||e.edit){const a=t.select(`:scope > g.${P.content} > g.${P.text}`);a.on("mousedown",I),e.drag&&!n&&y(a),e.edit&&a.on("click",H)}e.addNodeBtn&&t.select(`:scope > g.${P.content}`).on("mouseenter",Ze).on("mouseleave",Qe)};function H(e,t){var n,a;const l=null==(n=this.parentNode)?void 0:n.parentNode;if(N&&x.value&&p.value){l.classList.add(P.edited),N=!1,x.value.attr("x",t.x-2).attr("y",t.y-w.data.y-2).attr("data-id",t.id).attr("data-name",t.name).style("display","");const e=p.value;e.textContent=t.name,e.focus(),null==(a=getSelection())||a.selectAllChildren(e)}}const K=()=>{var e;if(null==(e=document.getElementsByClassName(P.edited)[0])||e.classList.remove(P.edited,P.selected),h.value&&p.value){h.value.style.display="none";const e=h.value.getAttribute("data-id"),t=h.value.getAttribute("data-name"),n=p.value.textContent;e&&null!==n&&n!==t&&ee(e,n)}},I=(e,t)=>{e.stopPropagation(),R(t)},q=(e,t)=>{const n=ae(t.id,"");if(!g.value||!n)return;const a=g.value.selectAll(`g[data-id='${je(n)}'] g.${P.text}`).node();a&&(N=!0,H.call(a,e,n))},Y=e=>{if(e.preventDefault(),!s.value)return;const t=((e,t)=>{const{pageX:n,pageY:a}=t,l=e.getBoundingClientRect();return{left:n-(l.left+window.pageXOffset),top:a-(l.top+window.pageYOffset)}})(s.value,e);ue.value=t;const n=e.composedPath().find((e=>{var t;return null==(t=e.classList)?void 0:t.contains("node")}));if(n){const{classList:e}=n,t=e.contains(P.collapse);e.contains(P.selected)||R(n),ge.value.disabled=t,me.value.disabled=e.contains(P.root),pe.value.disabled=!t,he.value.disabled=t||e.contains("leaf")}D.value=!n,G.emit("showContextmenu",!0)},F=(e,t)=>{oe(t.id)},J=e=>{m.value&&(e?(f(m.value),m.value.on("dblclick.zoom",null)):m.value.on(".zoom",null))},T=e=>{if(!p.value||!g.value)return;const t=g.value.selectAll(`g.${P.text}`);e?t.on("click",H):t.on("click",null)},W=e=>{if(!g.value)return;const t=g.value.selectAll(`g.node:not(.${P.root}) > g > g.${P.text}`);e?y(t):t.on(".drag",null)},X=e=>{if(!g.value)return;const t=g.value.selectAll(`g.${P.text}`);e?t.on("mousedown",I):t.on("mousedown",null)},Z=e=>{s.value&&(e?s.value.addEventListener("contextmenu",Y):s.value.removeEventListener("contextmenu",Y))},Q=(e=!0)=>{e&&se.snap(w.data),t.emit("update:modelValue",a.cloneDeep([w.data.rawData])),n.value=se.hasPrev,l.value=se.hasNext,A()},ee=(e,t)=>{w.rename(e,t),Q()},te=(e,t)=>{w.moveChild(e,t),Q()},ne=(e,t,n=0)=>{w.moveSibling(e,t,n),Q()},ae=(e,t)=>{const n=w.add(e,t);return Q(),n},le=e=>{w.delete(e),Q()},oe=e=>{w.expand(e),Q()},fe=e=>{w.collapse(e),Q()},ye=()=>{if(!m.value)return;const e=w.data;f.translateTo(m.value,0+e.width/2,0+e.height/2)},we=()=>{if(!m.value||!c.value||!r.value)return;const e=c.value.getBBox(),t=r.value.getBoundingClientRect(),n=Math.min(t.width/e.width,t.height/e.height),a=t.width/2,l=t.height/2,o=e.width*n/2,i=e.height*n/2,s=u.translate(-e.x*n+a-o,-e.y*n+l-i).scale(n);f.transform(m.value,s)},_e=e=>{m.value&&f.scaleBy(m.value,e?1.1:.9)};return{wrapperEle:s,svgEle:r,gEle:c,style:P,asstSvgEle:d,foreignEle:h,foreignDivEle:p,centerView:ye,fitView:we,download:()=>{var e,t;s.value&&(e=s.value,t=w.data.name,o(e).then((e=>{const n=e.toDataURL(),a=open();a&&(a.document.write(`<img src='${n}'>`),a.document.title=t,a.document.close())})))},showViewMenu:D,viewMenu:xe,nodeMenu:ve,contextmenuPos:ue,onClickMenu:e=>{if("zoomfit"===e)we();else if("zoomin"===e)_e(!0);else if("zoomout"===e)_e(!1);else if("add"===e){const e=B(`.${P.selected}`).data()[0];q(new MouseEvent("click"),e)}else if("delete"===e){const e=B(`.${P.selected}`).data()[0];le(e.id)}else if("collapse"===e){const e=B(`.${P.selected}`).data()[0];fe(e.id)}else if("expand"===e){const e=B(`.${P.selected}`).data()[0];oe(e.id)}},next:()=>{const e=se.next();e&&(w.data=e,Q(!1))},prev:()=>{const e=se.prev();e&&(w.data=e,Q(!1))},hasPrev:n,hasNext:l}}});const at={ref:"gEle"},lt={ref:"foreignEle",style:{display:"none"}},ot={ref:"foreignDivEle",contenteditable:""},it={ref:"asstSvgEle"};nt.render=function(e,t,n,a,l,o){const i=N("contextmenu");return b(),v("div",{class:e.style.container},[x("div",{id:e.style["svg-wrapper"],ref:"wrapperEle"},[(b(),v("svg",{class:e.style.svg,ref:"svgEle"},[x("g",at,[(b(),v("foreignObject",lt,[x("div",ot,null,512)],512))],512)],2))],8,["id"]),(b(),v("svg",it,null,512)),x("div",{class:[e.style["button-list"],e.style["right-bottom"]]},[e.centerBtn?(b(),v("button",{key:0,onClick:t[1]||(t[1]=t=>e.centerView())},[x("i",{class:e.style.gps},null,2)])):D("",!0),e.fitBtn?(b(),v("button",{key:1,onClick:t[2]||(t[2]=t=>e.fitView())},[x("i",{class:e.style.fit},null,2)])):D("",!0),e.downloadBtn?(b(),v("button",{key:2,onClick:t[3]||(t[3]=t=>e.download())},[x("i",{class:e.style.download},null,2)])):D("",!0)],2),e.timetravel?(b(),v("div",{key:0,class:[e.style["button-list"],e.style["right-top"]]},[x("button",{onClick:t[4]||(t[4]=(...t)=>e.prev&&e.prev(...t)),class:{[e.style.disabled]:!e.hasPrev}},[x("i",{class:e.style.prev},null,2)],2),x("button",{onClick:t[5]||(t[5]=(...t)=>e.next&&e.next(...t)),class:{[e.style.disabled]:!e.hasNext}},[x("i",{class:e.style.next},null,2)],2)],2)):D("",!0),e.contextmenu?(b(),v(i,{key:1,position:e.contextmenuPos,groups:e.showViewMenu?e.viewMenu:e.nodeMenu,onClickItem:e.onClickMenu},null,8,["position","groups","onClickItem"])):D("",!0)],2)};var st=h({name:"App",components:{Mindmap:nt},setup(){const e=S({"center-btn":{value:!0},"fit-btn":{value:!0},timetravel:{value:!0},"download-btn":{value:!0},"add-node-btn":{value:!0},keyboard:{value:!1,disabled:!0},zoom:{value:!0},drag:{value:!0},edit:{value:!0},contextmenu:{value:!0},"sharp-corner":{value:!1},vertical:{value:!1,disabled:!0}}),t=S({branch:{value:Ce,min:1,max:6},"x-gap":{value:Ne,min:0,max:100},"y-gap":{value:Ee,min:0,max:100}});return{data:i(j),checkboxList:e,rangeList:t}}});const rt={class:"container"},ct=x("div",{class:"left-top"},[x("a",{href:"https://github.com/hellowuxin/vue3-mindmap",target:"_blank"},"GitHub")],-1),dt=x("div",{class:"right-top"},[x("span",null,"Props")],-1),ut={class:"right-bottom"};st.render=function(e,t,n,a,l,o){const i=N("mindmap");return b(),v("div",rt,[ct,dt,x(i,{class:"left-bottom",modelValue:e.data,"onUpdate:modelValue":t[1]||(t[1]=t=>e.data=t),branch:e.rangeList.branch.value,"x-gap":e.rangeList["x-gap"].value,"y-gap":e.rangeList["y-gap"].value,zoom:e.checkboxList.zoom.value,"fit-btn":e.checkboxList["fit-btn"].value,"center-btn":e.checkboxList["center-btn"].value,"download-btn":e.checkboxList["download-btn"].value,drag:e.checkboxList.drag.value,edit:e.checkboxList.edit.value,"add-node-btn":e.checkboxList["add-node-btn"].value,"sharp-corner":e.checkboxList["sharp-corner"].value,contextmenu:e.checkboxList.contextmenu.value,timetravel:e.checkboxList.timetravel.value},null,8,["modelValue","branch","x-gap","y-gap","zoom","fit-btn","center-btn","download-btn","drag","edit","add-node-btn","sharp-corner","contextmenu","timetravel"]),x("div",ut,[(b(!0),v(f,null,y(e.checkboxList,((e,t)=>(b(),v("div",{key:t},[m(x("input",{type:"checkbox",name:t.toString(),"onUpdate:modelValue":t=>e.value=t,disabled:e.disabled},null,8,["name","onUpdate:modelValue","disabled"]),[[V,e.value]]),x("label",{for:t.toString()},w(t),9,["for"])])))),128)),(b(!0),v(f,null,y(e.rangeList,((e,t)=>(b(),v("div",{key:t},[m(x("input",{type:"range",name:t,"onUpdate:modelValue":t=>e.value=t,min:e.min,max:e.max},null,8,["name","onUpdate:modelValue","min","max"]),[[z,e.value,void 0,{number:!0}]]),x("label",{for:t},w(t)+"（"+w(e.value)+"）",9,["for"])])))),128))])])},A(st).mount("#app");
